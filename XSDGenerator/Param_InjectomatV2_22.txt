/***************************************************************************/
/*                                                                         */
/*                                Param.txt                                */
/*                                                                         */
/***************************************************************************/
/* :mode=maatel-param:                                                     */
/*                                                                         */
/* Description paramètres Injectomat V2                                    */
/*                                                                         */
/***************************************************************************/
/* Origine      : Injectomat V2                Version 0.2                 */
/*                14.01.2014  H. Cochet        Version 0.5                 */
/* Modification : 03.02.2015  E. Van Olden     Version 1.1                 */
/*    - [DCR#7592] z9[FIXED] : reprise p3[DEVICE_CONFIG]                   */
/*    - [PR#9501] z10[SYRINGES] : reprise p2[PARAM_SYR]                    */
/*    - [DCR#7013] z22[USER] : reprise p14[DPS]                            */
/*    - [DCR#9618] z22[USER] : reprise p18[OPT_SCREEN1]                    */
/*    - [DCR#7592] z22[USER] : reprise règles validité p18[OPT_SCREEN1],   */
/*      p22[MISCELLANEOUS], p25[PROGRAM_MODE], ajout p53[SEL_SYR_2],       */
/*      p54[SYR_DRUG]                                                      */
/*    - [PR#9499] z22[USER] : reprise p22[MISCELLANEOUS] (suppression      */
/*      MISC_2_SELECTASSISTANCE, non exploité pour Injectomat)             */
/*    - [DCR#9862] z22[USER] : reprise p44[MISCELLANEOUS2]                 */
/*    - [DCR#9563] : z26[SAVE] : reprise p10[CONTEXT_TCI], ajout           */
/*      p11[CONTEXT_TCI_GRAPH] et p12[CONTEXT_TCI_GRAPH_DATA]              */
/*    - [DCR#6971] reprise plages vérification poids patient (note #8)     */
/*    - reprise commentaires                                               */
/* Modification : 06.05.2015  E. Van Olden     Version 1.2                 */
/*    - [DCR#10878] [DCR#10922] ajout z20[TECHNICAL]                       */
/*    - [DCR#10878] ajout z20/p3[REL_OCCLUS]                               */
/*    - [DCR#10922] ajout z20/p2[WIFI_CURRENT]                             */
/*    - reprise commentaires                                               */
/* Modification : 01.07.2015  E. Van Olden     Version 1.3                 */
/*    - [PR#11061] reprise z21/p6[CAL_SYR]                                 */
/*    - [DCR#11313] ajout z20/p4[CALC_FORCE]                               */
/*    - reprise commentaires                                               */
/* Modification : 24.07.2015  E. Van Olden     Version 1.4                 */
/*    - [PR#12225] reprise z22/p16[END_INFUS]/DurSilAlKvo                  */
/*    - reprise commentaires                                               */
/* Modification : 28.10.2015  E. Van Olden     Version 1.5                 */
/*    - reprise commentaires                                               */
/* Modification : 16.02.2016  C. Clavel        Version 2.0                 */
/*    - [DCR#14148] reprise z22/p18[OPT_SCREEN1] et z26/p7[CONTEXT_MC]     */
/*    - [DCR#14156] reprise z22/p18[OPT_SCREEN1] et z22/p43[OPT_SCREEN2]   */
/*    - [DCR#14160] ajout z22/p43[OPT_SCREEN2]/Flags/OPTF2_ONCAREAREASET   */
/*    - [DCR#14163] reprise plages vérification poids patient (note #8)    */
/*    - [DCR#14288] reprise z9/p3[DEVICE_CONFIG] supp. DEVCNF_INHTCI0ONSTOP*/
/*    - [DCR#14290] ajout z22/p22[MISCELLANEOUS] MISC_ONDISENGAG           */
/*    - [DCR#14291] reprise z10/p2[PARAM_SYR] et z20/p3[REL_OCCLUS]        */
/*    - [DCR#14299] ajout z9/p7[SOFT_DEV] SWDEV_INHTMPRESTARTCHARGE        */
/*    - [DCR#14300] reprise z10/[PARAM_SYR] FrictForce et StatForce        */
/*    - [DCR#14499] reprise commentaire MISC_INHSTARTKBDLOCK               */
/*    - [DCR#14503] ajout z22/p22[MISCELLANEOUS]MISC_VALIDFLOW_NOSTARTINFUS*/
/*    - [DCR#14533] ajout z9/p11[TRADE_ITEM_NUMBER]                        */
/*    - reprise commentaires                                               */
/* Modification : 29.07.2016  C. Clavel        Version 2.1                 */
/*    - [DCR#14681] ajout z22/p55[MEM_SEL2] et z22/p56[AUTO_KBD_LOCK]      */
/*    - [DCR#15319] ajout z22/p57[KBD_UNLOCK_CODE]                         */
/*    - [DCR#15320] ajout z26/p14[MEM_KBD_LOCK]                            */
/*    - reprise commentaires                                               */
/***************************************************************************/



#include "ConfigParam.h"
#define __SPECVALNAME
#include "..\_ConfPC\Decod.txt"



/*-------------------------------------------------------------------------*/
/* Attributs des paramètres                                                */
/*-------------------------------------------------------------------------*/

Chaque paramètre peut comporter les attributs suivants :
   - $noconfpc : l'absence du paramètre ou le fait qu'il ne soit pas valide
                 ne provoque pas un passage en configuration PC
   - $func : fonction spécifique pour la test de validité pour vérifier
             des règles plus évoluées qu'une simple comparaison par rapport
             à un minimum et un maximum
   - $accuracy paramètre dont la validité dépend de la précision fine ou
               grosse configurée dans le paramètre z8/p2[ACCURACY],
               voir note #6
   - $onlyMC : paramètre présent uniquement pour un appareil MC, erreur si
               tentative d'écriture dans un appareil standard
   - $onlyTiva : paramètre présent uniquement pour un appareil Tiva, erreur
                 si tentative d'écriture dans un appareil standard ou MC
                 (pour Injectomat uniquement)
   - $carearea : paramètre présent dans les care areas, care area invalide
                 si paramètre absent de la care area
   - $careareaopt : paramètre présent de manière optionnelle dans les care
                    areas, si paramètre absent de la care area utilisation de
                    sa valeur par défaut lors du chargement de la care area
   - $careareadefonload : paramètre redéfini avec sa valeur par défaut lors
                          du chargement de la care area
   - $nofield : paramètre sans description des champs : données de longueur
                variable pour informations bibliothèque et paramètres
                médicaments
   - $fixed : paramètre fixe, ne peut pas être écrit par l'application mais
              uniquement par le Boot
   - $blank : paramètre qui peut être écrit uniquement lorsque l'appareil
              est vierge

Note : tous les paramètres qui n'ont ni l'attribut '$carearea', ni l'attribut
'$careareaopt' ne peuvent pas être écrits dans les care areas.



/*-------------------------------------------------------------------------*/
/* Définition type appareil et version application                         */
/*-------------------------------------------------------------------------*/

#ifdef __INC_NUMVERS_C        /* si compilation depuis application */

#define __VERSION
#include "..\Main\Numvers.c"  /* type appareil et version depuis application */

$device NVERS_DEVICE
$version NVERS_VERSION NVERS_REVISION NVERS_CORRECT

#else /* __INC_NUMVERS_C */   /* pas compilation depuis application */

$device 0x43                  /* type appareil par défaut, Injectomat V2 */
$version "010 "               /* version application par défaut */

#endif /* __INC_NUMVERS_C */



/*-------------------------------------------------------------------------*/
/* Définitions générales                                                   */
/*-------------------------------------------------------------------------*/

$nb SYRINGES             100  nombre seringues
$nb SYR_REFERENCES       239  nombre numéros référence seringue

$nb SYR_TYPES              5  nombre types seringue

                              index type seringue dans tableaux paramètres
#define SYR_50CC           1  /* seringue 50cc */
#define SYR_30CC           2  /* seringue 30/35cc */
#define SYR_20CC           3  /* seringue 20/25cc  */
#define SYR_10CC           4  /* seringue 10cc */
#define SYR_5CC            5  /* seringue 5cc */

$nb DILUTION_UNIT         10  nombre unités dilution
$nb MASS_FLOW_UNIT        36  nombre unités débit massique

$nb LIBDRUGS               3  nombre bibliothèques médicaments
$nb DRUGS                200  nombre médicaments dans une bibliothèque

#define FLOW_MIN         100  /* débit minimum, 1/1000 ml/h */
#define FLOW_MAX     1200000  /* débit maximum, 1/1000 ml/h */

                              date/heure par défaut, minimum et maximum
#define DMM_DT  0 0 "31/12/2099 23:59:59"



/*-------------------------------------------------------------------------*/
/* Zone configuration globale                                              */
/*                                                                         */
/* Note : cette zone est utilisée pour des paramètres spécifiques dont le  */
/* contenu influe sur la vérification de validité pour des paramètres dans */
/* d'autres zones.                                                         */
/*-------------------------------------------------------------------------*/

$zone 8 GLOBAL G              zone configuration globale


                              informations sur la zone
$par 1 INFOS $noconfpc $func $careareaopt
   $structname InfosZone
   STRING(8) Version **       description version zone, notes #2 et #5
   DATETIME Create   DMM_DT   date/heure utilisateur génération données
   DATETIME ManChg   DMM_DT   date/heure utilisateur modification manuelle

Note : champ <ManChg> jamais mis à jour car aucun des paramètres n'est
modifiés dans les menus de configurations et de tests.
Note : informations affichées en Test 1 si paramètre présent et valide mais
pas traitées par application.


$par 2 ACCURACY $careareaopt  précision débit ml/h et volume ml
   BOOL Fine        FALSE 0 1 `- TRUE précision fine (2 décimales si inférieur
                                      à 10 ml/h ou 10 ml)
                               - FALSE précision grosse (jamais 2 décimales)

Note : ce paramètre est exploité pour vérifier la validité des paramètres
qui comporte l'attribut $accuracy ce qui inclut les paramètres des
médicaments z3x/p3[PARAM_DRUG]. Dans le cas de l'écriture d'une care area avec
commande Id-25h, il doit être écrit *AVANT* l'écriture d'un 1er médicament.
Pour l'écriture des paramètres courants avec commande Id-21h, la validité des
paramètres est analysée en exploitant la dernière valeur écrite de ce
paramètre. Si ce paramètre est modifié *APRES* l'écriture des paramètres, il
est possible qu'une erreur soit détectée pour des paramètres lors du prochain
démarrage ce qui va provoquer un passage en configuration/test PC.



/*-------------------------------------------------------------------------*/
/* Zone paramètres fixes                                                   */
/*                                                                         */
/* Note : cette zone est dénommée paramètres fixes car il est impossible   */
/* de modifier ces paramètres avec une commande Id-21h du logiciel         */
/* applicatif. Seul le Boot peut écrire ces paramètres pour une            */
/* configuration initiale de l'appareil.                                   */
/* Note : les paramètres avec l'attribut '$blank' ne peuvent être écrits   */
/* que lorsque l'appareil est vierge : aucun paramètre, aucune care area   */
/* et aucun événement dans l'historique.                                   */
/*-------------------------------------------------------------------------*/

$zone 9 FIXED F               zone paramètres fixes


                              informations sur la zone
$par 1 INFOS $noconfpc $func $fixed
   $usestruct InfosZone

Note : champ <ManChg> jamais mis à jour car aucun des paramètres n'est
modifiés dans les menus de configurations et de tests.
Note : informations affichées en Test 1 si paramètre présent et valide mais
pas traitées par application.


                              type appareil
$par 2 DEVICE_TYPE $func $fixed $blank
   $value @
   DWORD DeviceType      **   flags type appareil
      $bit  0 @DEVTYPE_MASSFLOW  FALSE * fonctions débit massique disponibles
      $bit  1 @DEVTYPE_LOAD      FALSE * fonction dose charge disponible
      $bit  2 @DEVTYPE_BOLP      FALSE * fonction bolus programmé disponible
      $bit  3 @DEVTYPE_KBDMC     FALSE * clavier MC (au lieu standard)
      $bit  4 @DEVTYPE_TCI       FALSE * fonctions Tci disponibles
      $bit 11 @DEVTYPE_GRAPH     FALSE * écrans graphique du menu disponibles
      $bit 13 @DEVTYPE_MELODY    FALSE * signalement sonore avec mélodies (au
                                         lieu bips)
      $bit 14 @DEVTYPE_WIFI      FALSE * présence module Wifi
      $bit 15 @DEVTYPE_INHIBITM2 FALSE * inhibition unités avec '/m²'
   $endvalue
   WORD DeviceTypeEx   0 0 0  extension flags type appareil [$h]
   $value @
   BYTE SubDeviceId    255 *  sous-type appareil, valeur émise dans le champ
                              <SubDevice> du sous-paquet appareil SubId-05h
                              du paquet de supervision, 255 si sous-type
                              non défini [$h]
   $endvalue
   BYTE Spare            0 *  champ disponible pour définition type appareil

Correct si :
   - <DeviceType>/DEVTYPE_TCI à FALSE si <DeviceType>/DEVTYPE_MASSFLOW à
     FALSE (il n'est pas possible d'avoir un appareil avec les fonctions
     Tci mais sans les fonctions débit massique)
Note : on considère qu'il s'agit d'un appareil MC (et donc les paramètres
avec l'attribut $onlyMC sont disponibles) si présence d'un des bits de
configuration :
   - @DEVTYPE_MASSFLOW fonctions débit massique disponibles
   - @DEVTYPE_LOAD fonction dose charge disponible
   - @DEVTYPE_BOLP fonction bolus programmé disponible
Note : on considère qu'il s'agit d'un appareil Tiva (et donc les paramètres
avec l'attribut $onlyTiva sont disponibles) si présence du bit @DEVTYPE_TCI
(fonctions Tci disponibles).
Note : le bits @DEVTYPE_KBDMC n'est pas pris en compte pour déterminer s'il
s'agit d'un appareil MC ou standard :
   - il est possible d'avoir un appareil standard avec un clavier MC ou un
     appareil MC ou un clavier standard
Note : l'état du bit @DEVTYPE_MELODY influe également sur les périodes de
clignotement des leds alarmes et pré-alarmes : clignotement normal si bips,
clignotement rapide pour alarme et lent pour pré-alarme si mélodies.


                              configurations spécifiques appareil
$par 3 DEVICE_CONFIG $func $fixed $blank
   $value @
   DWORD DeviceConfig     **  flags configuration *
                              inhibition démarrage perfusion pas possible si
                              concentration cible Tci à 0
      $bit  1 @DEVCNF_INHTCI0NOSTART    FALSE *
                              inhibition affichage débit à 0 dans écran arrêt
                              Tci, si bit à 0 affichage toujours débit à 0
                              dans écran arrêt Tci, si bit à 1 affichage débit
                              auquel on va démarrer comme dans les autres modes
      $bit  2 @DEVCNF_INHTCIFLOW0STOP   FALSE *
                              forçage mise à 0 volume limite ou volume/temps si
                              pas même traitement, implique affichage écran même
                              traitement dès que volume limite ou volume/temps
                              défini
      $bit  3 @DEVCNF_FORCE_RESET_VL_VT FALSE *
                              affichage systématique écran volume limite après
                              chaque changement de seringue
      $bit  4 @DEVCNF_MANDATORYVOLLIM   FALSE *
                             inhibition mémorisation paramètres perfusion
      $bit  5 @DEVCNF_INHMEMDRUGPARAM   FALSE *
                              inhibition affichage indice correction dans
                              écran initial et dans écrans maintenance
      $bit  6 @DEVCNF_INHVERSCORRECT    FALSE *
                              inhibition sélection volume limite à "Off"
      $bit  7 @DEVCNF_INHOFFVOLLIM      FALSE *
                              activation affichage écran avertissement si
                              débit perfusion plus grand que volume limite
      $bit  8 @DEVCNF_WARNFLOWVOLLIMIT  FALSE *
                              position fixe du point décimal
      $bit  9 @DEVCNF_FIXEDDECIMALPOINT FALSE *
                              inhibition changement unité pression en Util 4
                              (unité affichée mais non sélectionnable)
      $bit 10 @DEVCNF_INHPRESSUNIT      FALSE *
   $value @
   DWORD DeviceConfigEx 0 0 0 extension flags configuration [$h]

Correct si :
   - <DeviceType>/DEVCNF_INHOFFVOLLIM à FALSE si <DeviceType>/DEVCNF_MANDATORYVOLLIM
     à FALSE (il n'est pas possible d'inhiber la sélection du volume à "Off"
     si l'écran volume limite n'est pas obligatoire après chaque changement
     de seringue)

                              configurations matérielles
$par 4 HARD_CONFIG $fixed $blank
   DWORD HardConfig     0 0 0 flags configuration [$h]

Note : il n'y a aucune configuration matérielle actuellement.


$par 5 INH_ERROR $fixed       inhibition erreurs
   DWORD KeyInhError    **    clé validation inhibition erreurs, doit contenir
                              2FB7.FB17h pour prise en compte liste erreurs
                              inhibées [$h]
   DWORD InhError       **    liste erreurs inhibées
      $bit  0 @ERR_I_ROTATE       FALSE * rotation (1)
      $bit  1 @ERR_I_DISPLAC      FALSE * déplacement (2)
      $bit  3 @ERR_I_MICCONTSEC   FALSE * micro-contrôleur secondaire (13,14,15)
      $bit  4 @ERR_I_BATTERY      FALSE * batterie (16,17,19,54)
      $bit  5 @ERR_I_POTSYR       FALSE * potentiomètre diamètre seringue (20)
      $bit  6 @ERR_I_POTDISP      FALSE * potentiomètre déplacement (21)
      $bit  7 @ERR_I_FORCE        FALSE * capteur force (22)
      $bit  8 @ERR_I_FLANGES      FALSE * switch ailette (23)
      $bit  9 @ERR_I_DISENGAG     FALSE * switchs et fourche opto
                                          débrayage (24,33)
      $bit 10 @ERR_I_PLUNGHEAD    FALSE * fourche opto tête piston (25)
      $bit 11 @ERR_I_BOARD        FALSE * absence carte ou backlight Lcd (26,27)
      $bit 12 @ERR_I_KEYBOARD     FALSE * clavier (28)
      $bit 13 @ERR_I_ADC          FALSE * convertisseur analogique/digital (29)
      $bit 14 @ERR_I_HORODAT      FALSE * horodateur (30)
      $bit 16 @ERR_I_POWER        FALSE * signal présence secteur (18)
      $bit 17 @ERR_I_FLOWPERIOD   FALSE * contrôle débit, période et sens
                                          moteur (34,35,36)
      $bit 18 @ERR_I_KEYOFF       FALSE * touche Off (37,38)
      $bit 19 @ERR_I_CTRTCI       FALSE * contrôle calcul Tci (40)
      $bit 21 @ERR_I_LCD          FALSE * contrôleur Lcd (43,44,45)
      $bit 22 @ERR_I_BACKUP       FALSE * température et tensions super-capa
                                          et booster 5 V sécurité (46,47,49)
      $bit 23 @ERR_I_TETADEVICE   FALSE * température appareil (48)
      $bit 24 @ERR_I_SOUND        FALSE * haut-parleur et buzzer (51,52)
      $bit 25 @ERR_I_PARAMBAT     FALSE * paramètre batterie dans E²prom
                                          coulombmètre (53)
      $bit 26 @ERR_I_POWERVOLTAGE FALSE * tension bloc alimentation secteur (50)
      $bit 27 @ERR_I_CMDFAIL      FALSE * ligne CMD_FAIL (56)
   DWORD InhErrorEx     0 0 0 extension liste erreurs inhibées [$h]

Note : la liste des erreurs inhibées définie dans <InhError> et <InhErrorEx>
est exploitée uniquement si la clé <KeyInhError> contient la valeur adéquate.
Si <KeyInhError> contient une autre valeur que 2FB7.FB17h (ce qui inclut
FFFF.FFFFh lorsque la Flash est effacée), on considère que <InhError> et
<InhErrorEx> sont à 0.


$par 6 DEVICE_VALID $fixed    appareil opérationnel
   DWORD KeyDeviceValid  **   clé validation pour appareil opérationnel :
                                 - 110F.A4B6h : appareil opérationnel
                                 - 9405.E272h : appareil en cours maintenance
                                 - autre : appareil en cours production [$h]

Note : si <KeyDeviceValid> contient une autre valeur que 110F.A4B6h (ce qui
inclut FFFF.FFFFh lorsque la Flash est effacée), un écran d'avertissement que
l'appareil est en cours de production ou en cours de maintenance s'affiche à
chaque démarrage. Cet écran doit être acquitter pour utiliser l'appareil.


$par 7 SOFT_DEV $func $fixed  appareil avec logiciel en cours développement
   $value @
   DWORD KeySoftDev      0 *  clé déblocage fonctions mise au point pour
                              développement logiciel, doit contenir 5C5C.5C5Ch
                              pour que les fonctions de mise au point soient
                              accessibles [$h]
   $value @
   DWORD SoftDevConfig   **   configurations spécifiques pour développement
                              logiciel *

                              affichage date/heure événement avec les secondes
                              dans les écrans graphiques
      $bit 0 @SWDEV_GRAPHSECOND     FALSE *
                              activation trace sortie décharge profonde batterie
                              sur liaison Ttl
      $bit 1 @SWDEV_TRACEEXDISCH    FALSE *
                              inbibition tempo attente 1 h après fin charge
                              avant reprise charge si tension < 7.9 V
      $bit 2 @SWDEV_INHTMPRESTARTCHARGE \
                                    FALSE *

Correct si :
   - configurations spécifiques <SoftDevConfig> à 0 si absence clé déblocage
     fonctions mise au point (<KeySoftDev> différent de 5C5C.5C5Ch)
Note : si <KeySoftDev> contient 5C5C.5C5Ch, un écran d'avertissement que
l'appareil est équipé d'un logiciel en cours de développement s'affiche à
chaque démarrage. Cet écran doit être acquitter pour utiliser l'appareil. La
présence de la clé 'déverrouille' des fonctions de mise au point nécessaires
au développement du logiciel.


                              numéro série, notes #2 et #5
$par 8 SERIAL_NUMBER $func $fixed
   STRING(16) SerialNumber **

Note : affiché dans écran maintenance du menu et en Test 1.


$par 9 DATE_PROD $fixed       date/heure production appareil
   DATETIME DateProd  DMM_DT  date/heure utilisateur production appareil

Note : affiché en Test 1.


                              nom appareil, note #2
$par 10 DEVICE_NAME $func $fixed
                              nom affiché sur l'écran de démarrage
   STRING(32) DeviceName "Injectomat V2" *

Note : affiché sur écran démarrage, dans écran maintenance du menu et en
Test 1.


                              code article international (GTIN), notes #2 et #5
$par 11 TRADE_ITEM_NUMBER $func $fixed
   STRING(16) TradeItemNumber **

Note : même si le code article international n'est composé normalement que de
chiffres, il est possible d'écrire n'importe quels caractères dans ce
paramètre.
Note : le code article international est composé de 14 chiffres pour les
dispositifs médicaux. Par contre, la taille de <TradeItemNumber> est de 16
caractères car tous les paramètres fixes qui sont gérés par le Boot doivent
avoir une taille multiple de 4.
Note : affiché en Test 1.



/*-------------------------------------------------------------------------*/
/* Zone seringues                                                          */
/*                                                                         */
/* Zone modifiable en mode manuel. Les écritures effectuées avant une      */
/* commande fin configuration (paquet <Id-23h>) sont prises en compte au   */
/* moment du passage en sélection de seringue.                             */
/* A priori, zone pas modifiée en configuration manuelle donc <ManChg> de  */
/* INFOS jamais modifié par application.                                   */
/*-------------------------------------------------------------------------*/

$zone 10 SYRINGES SY          zone seringues

$par 1 INFOS $noconfpc $func  informations sur la zone
   $usestruct InfosZone

Note : champ <ManChg> jamais mis à jour car aucun des paramètres n'est
modifiés dans les menus de configurations et de tests.
Note : informations affichées en Test 1 si paramètre présent et valide mais
pas traitées par application.


                              tableau paramètres seringues
$par 2 PARAM_SYR [SYRINGES] $func
   $structname ParamSyr       paramètres seringues
                                    numéro référence seringue
   BYTE NumRef        *    1  NB_SYR_REFERENCES
   BYTE Volume        *    5   60   contenance seringue, ml
   STRING(20) Name    **            nom seringue, note #2
   WORD IntDiam       * 1050 3500   diamètre interne, 1/100 mm
   WORD ExtDiam       *  200 7000   diamètre externe, 1/100 mm
   WORD HardHeight    *  500 6000   hard-height, 1/100 mm
   WORD FrictForce    *    0 4000   force friction, g
   WORD StatForce     *    0 4000   force statique, g
   WORD FlowFastStart *    1 1000   débit démarrage rapide, ml/h
   BYTE Q             *    0  100   coefficient force statique pour démarrage
                                    rapide, %
   WORD PressCalib    *    1 7000   pression calibration, mmHg
   WORD SlopeOcc      *    1  999   pente occlusion, 1/10 mmHg/min
   WORD Step1ml       *    0 7000   nombre pas moteur pour 1 ml
   BYTE Flags         **            flags seringue :
      $bit 0 @SYR_LUERSLIP FALSE *  seringue type 'Luer slip'
      $bit 1 @SYR_RELOCCEXTRABACK \
                           FALSE *  besoin 3ème recul pour levée occlusion

Correct si :
   - nombre pas moteur pour 1 ml <Step1ml> correspond à la valeur attendue
   - période maximum pas moteur nécessaire pour perfuser au débit minimum,
     soit 0.1 ml/h, inférieure ou égale à 60 s (période la plus grande que
     le driver moteur est capable de générer)
   - période minimum pas moteur nécessaire pour perfuser au débit maximum,
     soit 1200 ml/h pour seringue 60cc, 600 ml/h pour seringue 30/35cc et
     20/25cc, 350 ml/h pour seringue 10cc ou 250 ml/h pour seringue 5cc,
     supérieure ou égale à 2 ms (période la plus petite que le driver moteur
     est capable de générer)
Note : un des problèmes ci-dessus (nombre pas moteur pour 1 ml, période
maximum et période minimum) est reporté par l'affichage d'une erreur
technique 31 lors du prochain démarrage et non pas par le retour d'un code
d'erreur ERRLIMIT lors de l'exécution de la commande Id-21h pour écrire le
paramètre.
Note : tous les champs à 0 pour définir une position inoccupée dans le tableau.
Note : le nombre de pas moteur pour 1 ml <Step1ml> doit être égal à la
formule :
   - <Step1ml> = ( <NbStep10mm> x 100 ) / section (mm²)
   - <NbStep10mm> nombre pas moteur pour avance de 10 mm du poussoir = 6000
   - la valeur écrite pour le champ doit être le résultat du calcul avec un
     arrondi à l'entier inférieur
   - exemple pour seringue 'BD Plastipak' avec diamètre interne de 22.47 mm :
        . ( 6000 x 100 ) / ( 26.47 x 26.47 x 3.141592654 / 4 ) = 1090
Note : calcul période pas moteur pour un débit :
   - période en µs dun pas moteur pour un débit de 1 nl/h (nano-litre par
     heure) <Per1nlh> :
        . <Per1nlh> = ( section (mm²) x 10000 x 3600e6 ) / <NbStep10mm>
   - période en µs à un certain débit en nl/h :
        . <Period> = <Per1nlh> / débit
   - exemple pour seringue 'BD Plastipak' avec diamètre interne de 22.47 mm :
        . ( ( 26.47 x 26.47 x 3.141592654 / 4 ) x 10000 x 3600e6 ) / 6000
        . <Per1nlh> = 4 203 965 400 000
   - exemple pour débit de 0.1 ml/h :
        . 4 203 965 400 000 / 100 000 = 42 039 654 µs
   - exemple pour débit de 1200 ml/h :
        . 4 203 965 400 000 / 1200 000 000 = 3 503 µs



/*-------------------------------------------------------------------------*/
/* Zone paramètres techniques                                              */
/*-------------------------------------------------------------------------*/

$zone 20 TECHNICAL T          zone paramètres techniques


$par 1 INFOS $noconfpc $func  informations sur la zone
   $usestruct InfosZone

Note : champ <ManChg> jamais mis à jour car aucun des paramètres n'est
modifiés dans les menus de configurations et de tests.
Note : informations affichées en Test 1 si paramètre présent et valide mais
pas traitées par application.


$par 2 WIFI_CURRENT           courant moyen consommé par module Wifi
   WORD Current    100 0 500  courant moyen consommé par module Wifi, mA

Note : le courant défini avec ce paramètre est pris en compte pour
l'évaluation du courant consommé par l'appareil uniquement si appareil avec
module Wifi (paramètre z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_WIFI à TRUE) et
si module Wifi activé (paramètre z22/p51[WIFI_STATE]/Enable à TRUE). Il est
ignoré si le module Wifi lui-même indique le courant qu'il consomme avec la
donnée DataId-0Fh de la commande Id-42h.
Note : ATTENTION : il s'agit du courant consommé sur la batterie ou le bloc
secteur en amont du régulateur du module Wifi et non pas le courant en sortie
de l'alimentation 3.3 V directement fourni au module Wifi ; il est donc
nécessaire de prendre en compte le ratio entre la tension d'entrée et la
tension de sortie et le rendement du régulateur.


$par 3 REL_OCCLUS $func       paramètres levée occlusion *
                              tableau paramètres levée occlusion pour chaque
                              type de seringue
   $struct ParamRelOcclusSyringe [SYR_TYPES]
      BYTE Dist           100  0  100  distance base pour calcul distance
                                       recul, 1/100 mm
      WORD Slope          350 30  500  pente pour calcul distance recul, 1/100000
      WORD ForceStop1     300 50  700  force arrêt 1er recul, g
      WORD FlowRate1      250 10  400  débit 1er recul, ml/h
      WORD ForceStop2     150 50  700  force arrêt 2ème recul, g
      WORD FlowRate2      150 10  400  débit 2ème recul, ml/h
      WORD VolBack3_50     50 10 1000  volume pour 3ème recul pour limite
                                       pression à 50 mmHg, 1/1000 ml
      WORD VolBack3_900   500 10 1000  volume pour 3ème recul pour limite
                                       pression à 900 mmHg, 1/1000 ml

   $struct ParamRelOcclus     paramètres généraux levée occlusion
      BYTE DurPause        50 10  100  durée pause après 1er recul avant test
                                       force pour démarrage éventuel 2ème
                                       recul, 100 ms
      WORD AddForceBack2  100 10  500  force à ajouter à force arrêt 1er
                                       recul pour obtenir force corrigée
                                       au-dessus de laquelle le 2ème recul
                                       est nécessaire, g
      WORD MaxVolBack2    200 50 1000  volume maximum pour 2ème recul, 1/1000 ml

Correct si :
   - volume recul à 50 mmHg <VolBack3_50> <= volume recul à 900 mmHg
     <VolBack3_900>

                              paramètres par défaut seringues 30/35cc
   $defminmax ParamRelOcclusSyringe[SYR_30CC].Dist           75 *
   $defminmax ParamRelOcclusSyringe[SYR_30CC].Slope         240 *
   $defminmax ParamRelOcclusSyringe[SYR_30CC].ForceStop1    200 *
   $defminmax ParamRelOcclusSyringe[SYR_30CC].FlowRate1     150 *
   $defminmax ParamRelOcclusSyringe[SYR_30CC].ForceStop2    100 *
   $defminmax ParamRelOcclusSyringe[SYR_30CC].FlowRate2     100 *

                              paramètres par défaut seringues 20/25cc
   $defminmax ParamRelOcclusSyringe[SYR_20CC].Dist           75 *
   $defminmax ParamRelOcclusSyringe[SYR_20CC].Slope         240 *
   $defminmax ParamRelOcclusSyringe[SYR_20CC].ForceStop1    200 *
   $defminmax ParamRelOcclusSyringe[SYR_20CC].FlowRate1     150 *
   $defminmax ParamRelOcclusSyringe[SYR_20CC].ForceStop2    100 *
   $defminmax ParamRelOcclusSyringe[SYR_20CC].FlowRate2     100 *

                              paramètres par défaut seringues 10cc
   $defminmax ParamRelOcclusSyringe[SYR_10CC].Dist           50 *
   $defminmax ParamRelOcclusSyringe[SYR_10CC].Slope         225 *
   $defminmax ParamRelOcclusSyringe[SYR_10CC].ForceStop1    200 *
   $defminmax ParamRelOcclusSyringe[SYR_10CC].FlowRate1     150 10 350
   $defminmax ParamRelOcclusSyringe[SYR_10CC].ForceStop2    100 *
   $defminmax ParamRelOcclusSyringe[SYR_10CC].FlowRate2     100 10 350

                              paramètres par défaut seringues 5cc
   $defminmax ParamRelOcclusSyringe[SYR_5CC].Dist            50 *
   $defminmax ParamRelOcclusSyringe[SYR_5CC].Slope          225 *
   $defminmax ParamRelOcclusSyringe[SYR_5CC].ForceStop1     200 *
   $defminmax ParamRelOcclusSyringe[SYR_5CC].FlowRate1      100 10 250
   $defminmax ParamRelOcclusSyringe[SYR_5CC].ForceStop2     100 *
   $defminmax ParamRelOcclusSyringe[SYR_5CC].FlowRate2       75 10 250


$par 4 CALC_FORCE             calcul force
   $struct ParamForce [SYR_TYPES]   paramètres correction force
      WORD Force0     400   0 1000  force exercée par bras anti-syphon, g
      BYTE Coeff1     100  50  100  coefficient ß1, 1/100
      BYTE Coeff2      87  50  100  coefficient ß2, 1/100

                                    coefficient ß2 seringues 30/35cc
   $defminmax ParamForce[SYR_30CC].Coeff2  82 *
                                    coefficient ß2 seringues 20/25cc, 10cc et 5cc
   $defminmax ParamForce[SYR_20CC].Coeff2  80 *
   $defminmax ParamForce[SYR_10CC].Coeff2  80 *
   $defminmax ParamForce[SYR_5CC].Coeff2   80 *



/*-------------------------------------------------------------------------*/
/* Zone étalonnages                                                        */
/*-------------------------------------------------------------------------*/

$zone 21 CALIB C              zone étalonnage


$par 1 INFOS $noconfpc $func  informations sur la zone
   $usestruct InfosZone

Note : champ <ManChg> jamais mis à jour car aucun des paramètres n'est
modifiés dans les menus de configurations et de tests.
Note : informations affichées en Test 1 si paramètre présent et valide mais
pas traitées par application.


$par 2 CAL_EXEC $noconfpc     informations exécution étalonnage manuel
   $value @                   infos exécution étalonnage pot. déplacement
   $struct ExecCal @ExecCalDisp
      DATETIME ManCal DMM_DT  date/heure utilisateur étalonnage manuel
      WORD CntCal     **      compteur nombre étalonnages manuel
   $value @                   infos exécution linéarisation pot. déplacement
   $usestruct ExecCal @ExecLinDisp
   $value @                   infos exécution étalonnage capteur force
   $usestruct ExecCal @ExecCalForce
   $value @                   infos exécution étalonnage potentiomètre seringue
   $usestruct ExecCal @ExecCalSyr
   $value @                   infos exécution ajustement capteur force
   $usestruct ExecCal @ExecCalForceAdjust

Note : informations affichées en test manuel mais jamais modifiées par
l'application (sauf <ExecCalForceAdjust> :
   - Test 5 : exécution étalonnage  <ExecCalForce> et ajustement
     <ExecCalForceAdjust> (date uniquement mais pas compteur) capteur force
   - Test 6 : exécution étalonnage <ExecCalDisp> et linéarisation <ExecLinDisp>
     potentiomètre déplacement
   - Test 7 : exécution étalonnage potentiomètre seringue <ExecCalSyr>
Note : les infos exécution ajustement capteur force <ExecCalForceAdjust>
sont mise à jour lors d'une extinction en mode manuel si un ajustement a été
effectué après le démarrage en mode manuel. Le compteur <CntCal> est
incrémenté s'il est inférieure à FFFFh, sinon il reste à cette valeur
maximum.
Note : le compteur d'ajustement du capteur force <ExecCalForceAdjust>/<CntCal>
indique normalement le nombre d'ajustements effectués depuis le dernier
étalonnage. Il doit donc être mis à 0 lors du l'écriture de l'étalonnage du
capteur de force z21/p5[CAL_FORCE].


$par 3 CAL_DISP $func         étalonnage potentiomètre déplacement
   WORD AdcLow       532 0 4095     valeur Adc à position basse (20 mm), Lsb
   WORD AdcHigh     3328 0 4095     valeur Adc à position haute (115 mm), Lsb
   $value
   BOOL LinValid   FALSE 0    1     linéarisation effectuée

Correct si :
   - Adc à position basse <AdcLow> compris entre 0.258 V (320 Lsb) et 0.645 V
     (800 Lsb)
   - Adc à position haute <AdcHigh> compris entre 2.256 V (2799 Lsb) et
     3.004 V (3728 Lsb)
   - différence <AdcHigh> - <AdcLow> comprise entre 1.773 V (2200 Lsb) et
     2.74 V (3400 Lsb)
Note : valeurs affichées en Test 6.


$par 4 LIN_DISP               linéarisation potentiomètre déplacement
   WORD[124] AdcLin   0 0 4095      `124 valeurs Adc, Lsb
                                       - 1ère valeur pour 132 mm
                                       - 2ème valeur pour 131 mm
                                       - ...
                                       - 18ème valeur pour 115 mm
                                       - ...
                                       - ...
                                       - 113éme valeur pour 20 mm
                                       - ...
                                       - 123ème valeur pour 10 mm
                                       - 124ème valeur pour 9 mm

Note : les valeur doivent être en ordre décroissant pour respecter
<AdcLin>[i] > <AdcLin>[i+1]. Cette règle n'est pas vérifiée lors de
l'écriture du paramètre mais uniquement lors du démarrage de l'appareil si
la linéarisation a été effectuée (paramètre z21/p3[CAL_DISP]/LinValid à
TRUE) : une erreur 21-0008 est générée si la règle n'est pas respectée.


$par 5 CAL_FORCE $func        étalonnage capteur force
   WORD Adc0kg       496 0 4095     valeur Adc pour force 0 kg, Lsb
   WORD Adc5kg      1800 0 4095     valeur Adc pour force 5 kg, Lsb
   WORD Dac         2350 0 4095     valeur Dac pour 0 capteur, Lsb

Correct si :
   - Adc pour force 0 kg <Adc0kg> compris entre 0.25 V (310 Lsb) et 0.55 V
     (683 Lsb)
   - Adc pour force 5 kg <Adc5kg> compris entre 0.8 V (993 Lsb) et 2.1 V
     (2606 Lsb)
   - différence <Adc5kg> - <Adc0kg> comprise entre 0.56 V (695 Lsb) et
     1.61 V (1998 Lsb)
Note : valeurs affichées en Test 5.


$par 6 CAL_SYR $func          étalonnage potentiomètre diamètre seringue
   WORD AdcLow       685 0 4095     valeur Adc à position basse (11 mm), Lsb
   WORD AdcMedium   1143 0 4095     valeur Adc à position médiane (22.9 mm), Lsb
   WORD AdcHigh     1508 0 4095     valeur Adc à position haute (33.0 mm), Lsb

Correct si :
   - Adc à position basse <AdcLow> compris entre 0.138 V (171 Lsb) et 0.967 V
     (1200 Lsb)
   - Adc à position médiane <AdcMedium> compris entre 0.460 V (571 Lsb) et
     1.382 V (1715 Lsb)
   - Adc à position haute <AdcHigh> compris entre 0.736 V (913 Lsb) et
     1.695 V (2103 Lsb)
   - différence <AdcMedium> - <AdcLow> supérieure à 0.165 V (205 Lsb)
   - différence <AdcHigh> - <AdcMedium> supérieure à 0.165 V (205 Lsb)
Note : valeurs affichées en Test 7.


                              étalonnage ajusté capteur force
$par 7 CAL_FORCE_ADJUST $func @par_ValidCalForce $noconfpc
   $usestruct CalForce

Correct si :
   - mêmes règles que pour étalonnage capteur force z21/p5[CAL_FORCE].
Note : valeurs affichées en Test 5.
Note : ce paramètre est écrit à l'extinction en mode manuel si un ajustement
de l'étalonnage du capteur force a été effectué après le démarrage de
l'appareil.



/*-------------------------------------------------------------------------*/
/* Zone utilisateur/service                                                */
/*-------------------------------------------------------------------------*/

$zone 22 USER U               zone utilisateur/service


$par 1 INFOS $noconfpc $func  informations sur la zone
   $usestruct InfosZone

Note : le champ <ManChg> est mis à jour avec la date/heure utilisateur
courante lors d'une modification d'un paramètre de la zone en
configuration/test manuel. Il n'est pas modifié lors de l'écriture d'un
paramètre à l'extinction de l'appareil en mode manuel.
Note : informations affichées en Test 1 si paramètre présent et valide mais
pas traitées par application.


$par 2 MAINT                  dates maintenance
   $value @
   DATETIME DateMaint DMM_DT  date utilisateur exécution maintenance,
                              0 si inconnue
   $value @
   DATETIME NextMaint DMM_DT  date utilisateur prochaine maintenance,
                              0 correspond à date minimum (01.01.2000)
   $value
   DATETIME ResetBat  DMM_DT  date utilisateur mise à zéro durée utilisation
                              sur batterie, 0 si inconnue

Note : champ <DateMaint> affiché en Test 2.
Note : champ <NextMaint> affiché en SAV 1.
Note : champ <ResetBat> affiché en Test 8.


$par 3 DUR_UTIL_U             durée utilisation
   $value                     durée utilisation totale
   $struct DurUtil
   DWORD Duration     **      durée utilisation depuis maintenance
                              précédente, s
   DWORD NbOn         **      nombre démarrages depuis maintenance précédente
   $value                     durée utilisation sur batterie
   $usestruct DurUtil @DurUtilBat
                              le champ <NbOn> représente le nombre de passages
                              sur batterie

Note : à chaque extinction, la durée depuis le démarrage précédent est cumulée
à <DurUtil>/<Duration> et <DurUtil>/<NbOn> est incrémenté. De même, la durée
de fonctionnement sur batterie depuis le démarrage précédent est cumulée à
<DurUtilBat>/<Duration> et le nombre de passages sur batterie est ajouté à
<DurUtilBat>/<NbOn>. Suite à une écriture puis un redémarrage, le contenu de
ce paramètre est donc différent lors de la prochaine lecture.
Note : champ <DurUtil>/<Duration> affiché en Test 2.
Note : champ <DurUtilBat>/<Duration> affiché en Test 8 sous la forme d'un
nombre de cycles (avec une durée de cycle de 7 h).


$par 4 DATE_OFFSET $noconfpc  offset date/heure
   SDWORD Offset      0 *     offset entre date/heure interne et date/heure
                              utilisateur, s

Note : modifié en Pompe/Util 7 et dans écran du menu.


$par 5 SERVICE_NAME $func     nom service, notes #2 et #5
   STRING(20) Name    **

Note : affiché :
   - sur écran démarrage (sauf si présence nom care area et pas écran
     confirmation care area au démarrage)
   - dans écran maintenance du menu
   - éventuellement sur ligne nom service si activée


$par 6 LANGUAGE               identificateur langue active, notes #1 et #5
   STRING(3) LangId   * "   " "~~~"

Note : modifié en Pompe/Util 8.
Note : utilisation 1ère langue définie dans les ressources si identificateur
ne correspond à aucune langue présente dans les ressources.


$par 7 LCD_CONTRAST           contraste Lcd
   BYTE Contrast    170 0 201

Note : modifié en Pompe/Util 3.


$par 8 BUZZER1                paramètres effets sonore (pas dans care area)
   $value
   BYTE Mode        **        mode effets sonores *
                              autorisation silence alarme préventif
      $bit 1 @BUZ_PREVENTIVESILAL  FALSE *
   $value
   BYTE NbTone      1 1 2     nombre tonalités pour signalement sonore avec
                              bips
   $value
   BYTE DurSilence  0 0 100   durée silence entre 2 bips alarme, pré-alarme ou
                              indications, 100 ms, 0 pour durée par défaut
                              du bip

Note : champ <Mode>/BUZ_PREVENTIVESILAL modifié en Pompe/Par 37.
Note : champs <NbTone> et <DurSilence> exploités et modifiés en Pompe/Par 37
uniquement si signalement sonore avec bips (paramètre
z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_MELODY à FALSE).


                              mémorisation mode programmation
$par 9 MEM_PROGRAM_MODE $carearea
   BYTE ProgramMode 1 1 6     mode programmation [e_prgmMode!..\Control.h] :
                                 1 : sans nom médicament ml/h
                                 2 : sans nom médicament débit massique
                                 3 : nom médicament ml/h
                                 4 : nom médicament débit massique
                                 5 : Vigilant Drug'Lib
                                 6 : Tci

Correct si :
   - bit @PRGM_M_xxx correspondant à <ProgramMode> est à TRUE dans
     z22/p25[PROGRAM_MODE]/ModeEnable.
Note : mis à jour avec mode programmation courant à l'extinction si
changement mode programmation au démarrage.
Note : éventuellement ajusté en Par 22 après modification des modes de
programmation autorisés (bits @PRGM_M_xxx dans z22/p25[PROGRAM_MODE]/ModeEnable).


$par 10 MEM_SEL $carearea     mémorisation infos modifiables en mode manuel
   $value
   WORD Mem **                liste infos à mémoriser à l'extinction
      $bit 2 @MEM_PRESSLIM      TRUE  * mémorisation limite pression
      $bit 3 @MEM_DPSAUTO       TRUE  * mémorisation activation surveillance pression
      $bit 5 @MEM_SAMEINFUSION  FALSE * gestion écran même perfusion
   $value
                              durée conservation contexte pour écran même
                              perfusion, min
   WORD DurSameInfusion  (10*60) (1*60) (24*60)
   $value                     limite pression, mmHg
   WORD PressLim      450 50 900
   $value                     surveillance pression activée (état case à cocher)
   BOOL DpsAuto       TRUE 0 1

Note : champs <Mem>/MEM_SAMEINFUSION et <DurSameInfusion> modifiés en Par 3.
Note : champs <Mem>/MEM_PRESSLIM, <Mem>/MEM_DPSAUTO, <PressLim> et <DpsAuto>
modifiés en Util 4.
Note : la valeur dans le champ <PressLim> est toujours exprimée en mmHg
quelle que soit l'unité de pression définie dans z22/p19[PRESS_LIM]/Unit.
Note : champ <PressLim> mis à jour avec limite pression courante à
l'extinction si <Mem>/MEM_PRESSLIM à TRUE.
Note : champ <DpsAuto> mis à jour avec état courant à l'extinction si
<Mem>/MEM_DPSAUTO à TRUE.


$par 11 HIST_SEL_SYR          historique seringues sélectionnées
   $value @
   BOOL MemHistSelSyr FALSE 0 1  mémorisation historique seringues sélectionnées
   $value @
                              numéros référence seringues sélectionnées, 1 à
                              239, index 1 pour la plus récente
   BYTE[SYRINGES] HistSelSyr 0 0 NB_SYR_REFERENCES

Note : à chaque sélection d'une seringue, son numéro de référence est mis en
1ère position du tableau ; les autres numéros du tableau sont décalés vers
les positions suivantes. Si le numéro de référence de la seringue sélectionnée
est déjà présent dans le tableau, il est supprimé. A la prochaine sélection
de seringue la liste des seringues proposées est organisée selon les numéros
de référence dans le tableau.
Note : champ <HistSelSyr> mis à jour avec numéros référence des dernières
seringues sélectionnées à l'extinction si <MemHistSelSyr> à TRUE.

                              débits maximum au clavier
$par 12 MAX_FLOWRATE $func $accuracy $careareaopt
   $value @                   débit maximum seringue 50cc, 1/1000 ml/h
   DWORD MaxFlow50cc  120000 FLOW_MIN FLOW_MAX
   $value @                   débit maximum seringue 30cc, 1/1000 ml/h
   DWORD MaxFlow30cc   60000 FLOW_MIN 600000
   $value @                   débit maximum seringue 20cc, 1/1000 ml/h
   DWORD MaxFlow20cc   60000 FLOW_MIN 600000
   $value @                   débit maximum seringue 10cc, 1/1000 ml/h
   DWORD MaxFlow10cc   35000 FLOW_MIN 350000
   $value @                   débit maximum seringue 5cc, 1/1000 ml/h
   DWORD MaxFlow5cc    25000 FLOW_MIN 250000

Correct si :
   - voir note #7 pour <MaxFlow50cc>, <MaxFlow30cc>, <MaxFlow20cc>,
     <MaxFlow10cc>, et <MaxFlow5cc>
Note : modifié en Par 4.
Note : voir note #6.


                              mode démarrage rapide perfusion
$par 13 MODE_FAST_START $func $careareaopt
   BYTE Valid **              mode démarrage rapide perfusion
      $bit 0 @FS_FASTSTART     TRUE  * démarrage rapide
      $bit 1 @FS_PURGMANDATORY FALSE * purge obligatoire
      $bit 2 @FS_PURGADVICE    FALSE * écran avertissement purge conseillée

Correct si :
   - <Valid>/FS_PURGMANDATORY et <Valid>/FS_PURGADVICE pas tous les 2 deux
     armés
Note : champs <Valid>/FS_PURGMANDATORY et <Valid>/FS_PURGADVICE modifiés
en Par 7.


$par 14 DPS $func $carearea   informations surveillance pression
   $structname ParamDps
   $value
   WORD ThresholdIncr  200  50 415  seuil montée pression, mmHg
   $value
   WORD ThresholdDrop  200   0 415  seuil chute pression, mmHg, 0 pour
                                    désactiver surveillance chute, 100 au
                                    minimum si autre que 0

Note : modifié en Util 4.
Note : les valeurs dans les champs <ThresholdIncr> et <ThresholdDrop> sont
toujours exprimées en mmHg quelle que soit l'unité de pression définie
dans z22/p19[PRESS_LIM]/Unit.
Note : lors d'une modification en Util 4, la valeur maximum pour le seuil
chute <ThresholdDrop> est de 100 mmHg (ou 15 kPa (113 mmHg) ou 2.0 PSI
(103 mmHg)) en dessous de la limite pression maximum (soit limite variable
maximum z22/p19[PRESS_LIM]/MaxLimVar en mode variable, soit limite haute
z22/p19[PRESS_LIM]/HighLim en mode 3 niveaux). Cet écart minimum n'est pas
vérifié lors de l'écriture du paramètre avec une commande Id-21h.


                              tableau indicateurs seringues sélectionnables
                              (pas dans care area)
$par 15 SEL_SYR
                              tableau indicé par numéro référence seringue,
                              index 1 à 239
   BOOL[SYR_REFERENCES] SelSyr TRUE 0 1

Note : modifié en Pompe/Par 6.
Note : voir note z22/p53[SEL_SYR_2].


                              fin perfusion
$par 16 END_INFUS $func $accuracy $carearea
   $value @
   WORD Kvo1FlowRate 1000   0 5000  débit 1 perfusin Kvo, 1/1000 ml/h, 100
                                    au minimum, 0 pour ne pas proposer débit 1
   $value @
   WORD Kvo2FlowRate 2000   0 5000  débit 2 perfusin Kvo, 1/1000 ml/h, 100
                                    au minimum, 0 pour ne pas proposer débit 2
   $value @
   WORD MinVolLim     100 100 2000  offset par rapport à volume perfusé
                                    pour volume limite minimum, 1/1000 ml
   $value @                         durée pré-alarme fin perfusion, s
   WORD DurPreAl    (5*60) (1*60) (30*60)
   $value @                         durée silence alarme en perfusion Kvo, s
   WORD DurSilAlKvo (5*60) (1*60) (12*3600)
   $value
   BOOL EmptySyr      TRUE  0 1     mode seringue vide autorisé
   $value
   BOOL EnableCont    TRUE  0 1     perfusion continue pour débit Kvo autorisée

Correct si :
   - voir note #7 pour <Kvo1FlowRate> et <Kvo2FlowRate>
Note : champs <Kvo1FlowRate>, <Kvo2FlowRate>, <EnableCont> et <DurSilAlKvo>
modifiés en Util 5.
Note : champ <DurPreAl> modifié en Par 31.
Note : champ <EmptySyr> modifié en Par 8.
Note : voir note #6.


                              options écran (dans care area)
$par 18 OPT_SCREEN1 $func $carearea
   $value
   WORD Flags **              flags options
      $bit  0 @OPTF_DPSAUTO       TRUE  * présence case à cocher DPS dans
                                          écran pression
      $bit  3 @OPTF_SAMETHERAPY   FALSE * affichage écran même traitement
                                          après changement seringue
      $bit  5 @OPTF_SERVICE       FALSE * affichage ligne nom service en bas
                                          de l'écran
      $bit  6 @OPTF_GRAPHTCI      FALSE * écran graphique par défaut (au lieu
                                          écran texte) pour perfusion Tci
      $bit  8 @OPTF_PRESSURE      TRUE  * affichage logo pression
      $bit  9 @OPTF_BATTERY       FALSE * affichage logo batterie
   $value @
   DWORD MnuScreen1 **        liste écrans du menu activés :
      $bit  0 @OPTS_VOLLIMIT      TRUE  * volume limite
      $bit  1 @OPTS_VOLTIME       FALSE * volume/temps
      $bit  2 @OPTS_SOUNDLEVEL    FALSE * niveau sonore
      $bit  3 @OPTS_HISTORIC      FALSE * historique
      $bit  4 @OPTS_LIBDRUG       FALSE * bibliothèque médicament
      $bit  5 @OPTS_SYRINGE       FALSE * nom seringue
      $bit  7 @OPTS_BOLUSPROG     FALSE * écran bolus programmé
      $bit  8 @OPTS_PATIENT       FALSE * écran patient
      $bit  9 @OPTS_TCIWAKEUP     FALSE * écran concentration réveil Tci
      $bit 10 @OPTS_TCIINFO       FALSE * écran informations Tci
      $bit 11 @OPTS_HISTVOLINF    FALSE * historique volumes perfusés
      $bit 12 @OPTS_GRAPH_FLOW    FALSE * graphique débit
      $bit 13 @OPTS_GRAPH_PRESS   FALSE * graphique pression
      $bit 14 @OPTS_GRAPH_TCI     FALSE * graphique concentration Tci
      $bit 15 @OPTS_INFOCASET     FALSE * écran infos ensemble care areas
      $bit 16 @OPTS_INFOCAREAREA  FALSE * écran infos care area
      $bit 17 @OPTS_PAUSE         TRUE  * écran pause
      $bit 18 @OPTS_CLINICALINFO  FALSE * écran message information clinique
   $value
   BYTE Anim       1 1 2      type animation pour logo perfusion
                              [OPTA_!..\DefParam.h] :
                                 1 : seringue
                                 2 : bonhomme
   $value
   BYTE InfoLine   0 0 3      type ligne information sur écran de base
                              [OPTL_!..\DefParam.h] :
                                 0 : pas de ligne
                                 1 : volume perfusé
                                 2 : durée restante de perfusion
                                 3 : autonomie batterie

Correct si :
   - si <Flags>/OPTF_SERVICE armé, <MnuScreen1>/OPTS_SYRINGE armé également
   - <MnuScreen1>/OPTS_VOLTIME à FALSE si inhibition sélection volume limite
     à "Off" (z9/p2[DEVICE_CONFIG]/DeviceConfig/DEVCNF_INHOFFVOLLIM à TRUE)
   - <MnuScreen1>/OPTS_BOLUSPROG à FALSE si fonction bolus programmé non
     disponible (z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_BOLP à FALSE)
   - <MnuScreen1>/OPTS_PATIENT à FALSE si fonctions débit massique non
     disponibles (z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_MASSFLOW à FALSE)
   - <MnuScreen1>/OPTS_TCIWAKEUP, <MnuScreen1>/OPTS_TCIINFO et
     <MnuScreen1>/OPTS_GRAPH_TCI à FALSE si fonctions Tci non disponibles
     (z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_TCI à FALSE)
   - <MnuScreen1>/OPTS_GRAPH_FLOW, <MnuScreen1>/OPTS_GRAPH_PRESS et
     <MnuScreen1>/OPTS_GRAPH_TCI à FALSE si écrans graphique du menu non
     disponibles (z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_GRAPH à FALSE)
   - <InfoLine> à 0 si inhibition sélection volume limite à "Off"
     (z9/p2[DEVICE_CONFIG]/DeviceConfig/DEVCNF_INHOFFVOLLIM à TRUE)
Note : la présence de l'écran nom seringue dans le menu
(<MnuScreen1>/OPTS_SYRINGE armé) provoque la désactivation de l'affichage de
la ligne nom seringue dans les écrans de perfusion.
Note : si l'écran nom seringue dans le menu n'est pas affiché
(<MnuScreen1>/OPTS_SYRINGE désarmé), on a donc l'affichage de la ligne nom
seringue et il faut pas que la ligne nom service soit également affichée
(<Flags>/OPTF_SERVICE armé) car ces 2 lignes partagent le même emplacement.
Note : champ <Flags>/OPTF_DPSAUTO modifié en Util 4.
Note : champ <Flags>/OPTF_SAMETHERAPY modifié en Par 25.
Note : champs <Flags>/OPTF_SERVICE et <MnuScreen1>/OPTS_SYRINGE modifiés
en Par 15.
Note : champ <Flags>/OPTF_GRAPHTCI modifié en Util 13.
Note : champs <Flags>/OPTF_PRESSURE, <Flags>/OPTF_BATTERY, <Anim> et
<InfoLine> modifiés en Util 1 (standard).
Note : champs <MnuScreen1>/OPTS_GRAPH_FLOW, <MnuScreen1>/OPTS_GRAPH_PRESS et
<MnuScreen1>/OPTS_GRAPH_TCI modifiés en Util 12.
Note : autres bits champ <MnuScreen1> modifiés en Util 2 (standard).


                              limites pression
$par 19 PRESS_LIM $func $carearea
   $value @                   limite pression variable maximum, mmHg
   WORD MaxLimVar     900  450  900
   $value @                   limite basse en mode 3 niveaux, mmHg
   WORD LowLim        200   50  310
   $value @
                              limite moyenne en mode 3 niveaux, mmHg, écart
                              minimum de 100 mmHg (75 mmHg pour unité kPa)
                              avec limite basse
   WORD MediumLim     450  150  700
   $value @
                              limite haute en mode 3 niveaux, mmHg, écart
                              minimum de 100 mmHg (75 mmHg pour unité kPa)
                              avec limite moyenne
   WORD HighLim       900  225  900
   $value
   BYTE Mode          1 1 2   mode gestion alarme occlusion
                              [PRESS_M_!..\DefParam.h] :
                                 1 : limite pression variable
                                 2 : 3 niveaux
   $value
   BYTE Unit          0 0 2   unité pression [PRESS_U_!..\DefParam.h] :
                                 0 : mmHg
                                 1 : kPa
                                 2 : PSI

Correct si :
   - écart entre <LowLim> et <MediumLim> au minimum de 100 mmHg si unité mmHg
     ou PSI ou de 75 mmHg si unité kPa
   - écart entre <MediumLim> et <HighLim> au minimum de 100 mmHg si unité
     mmHg ou PSI ou de 75 mmHg si unité kPa
Note : tous les champs modifiés en Util 4.
Note : les valeurs dans les champs <MaxLimVar>, <LowLim>, <MediumLim> et
<HighLim> sont toujours exprimées en mmHg quelle que soit l'unité de pression
définie avec <Unit>.


$par 20 SYR_AUTO_VAL          auto-validation seringue
   BOOL AutoVal   FALSE 0 1

Note : pour que l'auto-validation soit effective, il faut qu'il n'y ait
qu'une seule seringue définie comme sélectionnable dans le paramètre
z22/p15[SEL_SYR]. Si ce n'est pas le cas, il n'y a pas d'auto-validation
quel que soit l'état de ce paramètre.
Note : modifié en Pompe/Par 5.


                              débits bolus simple
$par 21 BOLUS_FLOWRATE $func $accuracy $careareaopt
   $value @                   débit bolus simple seringue 50cc, 1/1000 ml/h
   DWORD BolsFlowRate50cc 1200000 50000 FLOW_MAX
   $value @                   débit bolus simple seringue 30cc, 1/1000 ml/h
   DWORD BolsFlowRate30cc  600000 50000 600000
   $value @                   débit bolus simple seringue 20cc, 1/1000 ml/h
   DWORD BolsFlowRate20cc  600000 50000 600000
   $value @                   débit bolus simple seringue 10cc, 1/1000 ml/h
   DWORD BolsFlowRate10cc  350000 50000 350000
   $value @                   débit bolus simple seringue 5cc, 1/1000 ml/h
   DWORD BolsFlowRate5cc   250000 50000 250000

Correct si :
   - voir note #7 pour <BolsFlowRate50cc>, <BolsFlowRate30cc>, <BolsFlowRate20cc>,
     <BolsFlowRate10cc>, <BolsFlowRate5cc>
Note : modifié en Par 9.
Note : voir note #6.


$par 22 MISCELLANEOUS $func   configurations diverses (pas dans care area)
   $value
   WORD Flags **              flags configuration *
                              mise sous tension automatique avec débrayage
      $bit  2 @MISC_ONDISENGAG            FALSE *
                              touche START pas acceptée pour démarrer la
                              perfusion si clavier verrouillé (par défaut
                              démarrage perfusion possible avec touche
                              START même si clavier verrouillé)
      $bit  5 @MISC_INHSTARTKBDLOCK       FALSE *
                              activation sélection dilution avec volume seringue
                              en mode sans nom médicament débit massique et
                              nom médicament débit massique et "Médicament X (dose)"
      $bit  8 @MISC_SDILVOLSYR             FALSE *
                              validation débit ne provoque pas démarrage
                              perfusion (mais retour à lancement ou arrêt)
      $bit 15 @MISC_VALIDFLOW_NOSTARTINFUS FALSE *
   $value
   WORD Flags2 **             `2ème groupe flags configuration *
                              activation suppression 0 non significatifs
      $bit 1 @MISC_2_REMOVETRAILZERO       FALSE *
                              activation suppression 0 non significatifs y
                              compris pendant sélection
      $bit 2 @MISC_2_REMOVETRAILZEROSELECT FALSE *
                              affichage écran information durée avant
                              prochaine maintenance
      $bit 4 @MISC_2_DISPDURNEXTMAINT      FALSE *

Correct si :
   - <Flags2>/MISC_2_REMOVETRAILZERO et <Flags2>/MISC_2_REMOVETRAILZEROSELECT
     à FALSE si position fixe du point décimal
     (z9/p2[DEVICE_CONFIG]/DeviceConfig/DEVCNF_FIXEDDECIMALPOINT à TRUE)
Note : champ <Flags>/MISC_ONDISENGAG modifié en Pompe/Par 28.
Note : champs <Flags2>/MISC_2_REMOVETRAILZERO et
<Flags2>/MISC_2_REMOVETRAILZEROSELECT modifiés en Pompe/Par 35.
Note : champ <Flags2>/MISC_2_DISPDURNEXTMAINT modifié en SAV 4.


$par 23 MONTH_MAINT $noconfpc nombre mois avant prochaine maintenance
   BYTE MonthMaint 36 0 36


                              fonctions perfusion autorisées
$par 24 INFUS_FUNC $func $carearea
   $value @
   WORD InfusEnable **        fonctions perfusion autorisés
      $bit 2 @INFUS_B_BOLS  TRUE  *  bolus simple
      $bit 6 @INFUS_B_LOAD  FALSE *  dose de charge
      $bit 7 @INFUS_B_BOLP  FALSE *  bolus programmé
   $value @
   BYTE BeepEndFuncInfus **   activation bip en fin fonction perfusion au
                              moment démarrage primaire
      $bit 1 @BEEP_END_LOAD FALSE *  fin perfusion dose charge
      $bit 2 @BEEP_END_BOLP FALSE *  fin perfusion bolus programmé

Correct si :
   - <InfusEnable>/INFUS_B_LOAD à FALSE si fonction dose charge non
     disponible (z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_LOAD à FALSE)
   - <InfusEnable>/INFUS_B_BOLP à FALSE si fonction bolus programmé non
     disponible (z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_BOLP à FALSE)
   - <BeepEndFuncInfus>/BEEP_END_LOAD à FALSE si fonction dose charge non
     disponible
   - <BeepEndFuncInfus>/BEEP_END_BOLP à FALSE si fonction bolus programmé
     non disponible
Note : champs <InfusEnable>/INFUS_B_BOLS, <InfusEnable>/INFUS_B_LOAD et
<InfusEnable>/INFUS_B_BOLP modifiés en Par 19.


                              paramètres mode programmation
$par 25 PROGRAM_MODE $func $carearea
   $value
   BYTE ModeEnable  **        modes programmation autorisés
      $bit 1 @PRGM_M_VIGILANT     FALSE *  `Vigilant Drug'Lib
      $bit 2 @PRGM_M_TCI          FALSE *  `Tci
      $bit 3 @PRGM_M_NONAME_MLH   TRUE  *  sans nom médicament ml/h
      $bit 4 @PRGM_M_NONAME_MF    FALSE *  sans nom médicament débit massique
      $bit 5 @PRGM_M_DRUGLIST_MLH FALSE *  nom médicament ml/h
      $bit 6 @PRGM_M_DRUGLIST_MF  FALSE *  nom médicament débit massique
   $value
   BYTE DrugEnable **         médicaments spécifiques autorisés
      $bit 0 @PRGM_D_XMLH         FALSE *  `"Médicament X (ml/h)"
      $bit 1 @PRGM_D_XMF          FALSE *  `"Médicament X (dose)"
      $bit 2 @PRGM_D_TOP          FALSE *  positionement "Médicament X" en
                                           haut listes (en bas listes si FALSE)

Correct si :
   - champ <ModeEnable> parmi une des combinaisons suivantes :
        . @PRGM_M_NONAME_MLH : sans nom médicament ml/h seul
        . @PRGM_M_NONAME_MLH + @PRGM_M_TCI : sans nom médicament ml/h + Tci
        . @PRGM_M_NONAME_MLH + @PRGM_M_NONAME_MF : sans nom médicament ml/h +
          sans nom médicament débit massique, uniquement si fonctions débit
          massique disponibles (z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_MASSFLOW
          à TRUE)
        . @PRGM_M_NONAME_MLH + @PRGM_M_NONAME_MF + @PRGM_M_TCI : sans nom
          médicament ml/h + sans nom médicament débit massique + Tci,
          uniquement si fonctions débit massique disponibles
        . @PRGM_M_DRUGLIST_MLH : nom médicament ml/h seul
        . @PRGM_M_DRUGLIST_MF : nom médicament débit massique seul, uniquement
          si fonctions débit massique disponibles
        . @PRGM_M_DRUGLIST_MLH + @PRGM_M_DRUGLIST_MF : nom médicament ml/h +
          nom médicament débit massique, uniquement si fonctions débit
          massique disponibles
        . @PRGM_M_VIGILANT : Vigilant Drug'Lib seul
        . @PRGM_M_VIGILANT + @PRGM_M_TCI : Vigilant Drug'Lib + Tci
        . @PRGM_M_TCI : Tci seul
   - si <ModeEnable>/PRGM_M_VIGILANT : appareil est type MC
   - si <ModeEnable>/PRGM_M_TCI : appareil est type Tiva
   - si <ModeEnable>/PRGM_M_DRUGLIST_MLH ou <ModeEnable>/PRGM_M_DRUGLIST_MF :
     au moins un médicament dans bibliothèque liste noms médicaments (zone 30)
   - si <ModeEnable>/PRGM_M_VIGILANT : au moins un médicament dans bibliothèque
     Vigilant Drug'Lib (zone 31)
   - si <ModeEnable>/PRGM_M_TCI : au moins un médicament dans bibliothèque
     Tci (zone 32)
   - si <DrugEnable>/PRGM_D_XMLH à TRUE : présence @PRGM_M_VIGILANT ou
     @PRGM_M_DRUGLIST_MLH dans <DrugEnable>
   - si <DrugEnable>/PRGM_D_XMF à TRUE : présence @PRGM_M_VIGILANT,
     @PRGM_M_DRUGLIST_MLH ou @PRGM_M_DRUGLIST_MF dans <DrugEnable>
   - si <DrugEnable>/PRGM_D_XMF à TRUE : fonctions débit massique disponibles
     (paramètre z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_MASSFLOW à TRUE)
Note : champs <ModeEnable>/PRGM_M_NONAME_MF, <ModeEnable>/PRGM_M_DRUGLIST_MF
et <ModeEnable>/PRGM_M_TCI modifiés en Par 22.
Note : le bit @PRGM_D_XMF qui permet d'autoriser "Médicament X (dose)" peut
être armé si uniquement le mode sans nom médicament ml/h (bit
@PRGM_M_NONAME_MLH) est présent. En effet, dans ce cas la configuration
Par 22 peut armer le bit @PRGM_M_DRUGLIST_MF et on obtient alors un mode de
programmation nom médicament débit massique avec "Médicament X (dose)"
autorisé.


                              mémorisation paramètres mode débit massique
$par 26 MEM_MASSFLOW $onlyMC $careareadefonload
   DWORD Dilution        0 *  valeur dilution, 1/1000 unité
   UNIT DilutionUnit     0 *  unité dilution, 0 si médicament sans dilution
   WORD DilutionVolume   0 *  volume associé à dilution, ml
   DWORD Weight          0 *  poids patient, g, 0 si absence poids patient
   WORD Bsa              0 *  surface patient, 1/1000 m², 0 si absence surface
                              patient
   DWORD MassFlow        0 *  débit massique, 1/1000 unité, à 0 si débit ml/h
   UNIT MassFlowUnit     0 *  unité débit massique, 0 si débit ml/h uniquement

Note : ce paramètre est toujours écrits à l'extinction en mode manuel :
   - avec les valeurs courantes si mémorisation numéro médicament et
     paramètres perfusion (z22/p37[ENABLE_MEM_DRUG]/MEMD_DRUGPARAM à TRUE)
     sauf si médicament courant est un médicament depuis la bibliothèque
     Vigilant Drug'Lib (zone 31) ou depuis la bibliothèque Tci (zone 32)
   - avec les valeurs par défaut (tout à 0) dans le cas contraire
Note : ce paramètre est écrit avec les valeurs par défaut lors de l'extinction
en mode veille, configuration/test PC et configuration/test manuel si un des
paramètres liés à la configuration de la perfusion a été écrit, note #9.


                              paramètres mode nuit
$par 27 NIGHT_MODE $noconfpc $careareaopt
   $value
   WORD Flags **              flags options mode nuit
      $bit 0 @NM_LOWBACKLIGHT TRUE  *  réduction luminosité back-light
      $bit 1 @NM_LOWLEDS      TRUE  *  réduction luminosité leds
      $bit 2 @NM_INHBEEPKEY   TRUE  *  inhibition bip touche
      $bit 3 @NM_MANUAL       FALSE *  mode manuel (présence écrans dans
                                       menu manuel)
      $bit 4 @NM_AUTO         FALSE *  mode automatique (avec <FromHour> et
                                       <ToHour>)
   $value
                              heure début mode nuit automatique, min à partir
                              de minuit
   WORD FromTime  (21*60) 0 ((23*60)+59)
   $value
                              heure fin mode nuit automatique, min à partir
                              de minuit
   WORD ToTime    ( 6*60) 0 ((23*60)+59)

Note : modifié en Par 18.


                              paramètres patient
$par 28 PARAM_PATIENT $func $onlyMC $careareaopt
   $value                     poids patient par défaut, g
   DWORD DefaultWeight 70000  250  350000
   $value                     poids patient minimum, g
   DWORD MinWeight       250  250  350000
   $value                     poids patient maximum, g
   DWORD MaxWeight    350000  250  350000
   $value                     `Bsa patient par défaut, 1/1000 m²
   WORD DefaultBsa      2500   50    4500
   $value                     `Bsa patient minimum, 1/1000 m²
   WORD MinBsa            50   50    4500
   $value                      `Bsa patient maximum, 1/1000 m²
   WORD MaxBsa          4500   50    4500

Correct si :
   - poids par défaut <DefaultWeight>, minimum <MinWeight> et maximum
     <MaxWeight> multiples de coefficient selon valeur, note #8
   - poids minimum <MinWeight> <= poids maximum <MaxWeight>
   - poids minimum <MinWeight> <= poids par défaut <DefaultWeight>
   - poids par défaut <DefaultWeight> <= poids maximum <MaxWeight>
   - Bsa par défaut <DefaultBsa>, minimum <MinBsa> et maximum <MaxBsa>
     multiples de 10 (0.01 m²)
   - Bsa minimum <MinBsa> <= Bsa maximum <MaxBsa>
   - Bsa minimum <MinBsa> <= Bsa par défaut <DefaultBsa>
   - Bsa par défaut <DefaultBsa> <= Bsa maximum <MaxBsa>
Note : modifié en Par 23.


                              paramètres patient mode Tci
$par 30 PARAM_PATIENT_TCI $func $onlyTiva $careareaopt
   $value
                               âge patient par défaut, mois, 12 à 1800 mois
                               pour 1 à 150 ans
   WORD DefaultAge (40*12) (1*12) (150*12)
   $value                      taille patient par défaut, cm
   WORD DefaultHeight   175 20 250
   $value                      taille patient minimum, cm
   WORD MinHeight        20 20 250
   $value                      taille patient maximum, cm
   WORD MaxHeight       250 20 250

Correct si :
   - âge par défaut <DefaultAge> multiple de 12
   - taille minimum <MinHeight> <= taille maximum <MaxHeight>
   - taille minimum <MinHeight> <= taille par défaut <DefaultHeight>
   - taille par défaut <DefaultHeight> <= taille maximum <MaxHeight>
Note : modifié en Par 23.


                              validation des unités
$par 32 ENABLE_UNIT $func $onlyMC $careareaopt
   $value                     unités dilution
   BOOL[DILUTION_UNIT]  Dilution TRUE 0 1
   $value                     unités débit massique
   BOOL[MASS_FLOW_UNIT] MassFlow TRUE 0 1
   $value
   BYTE EnablePer **          type dilution et 'ml' pour dose
      $bit 0 @PER_DIL_ML   TRUE  * dilution '/ml'
      $bit 1 @PER_DIL_XML  TRUE  * dilution '/Xml'
      $bit 7 @PER_U_ML     FALSE * 'ml', pour autoriser 'ml' dans liste unités
                                   dose charge et bolus programmé avec
                                   médicament "Médicament X (dose)"

Correct si :
   - au moins une unité de dilution validée dans <Dilution>
   - au moins une unité de débit massique validée dans <MassFlow>
   - <MassFlow>[14] ('mg/m²/h') et <MassFlow>[15] ('mg/m²/24h') à FALSE si
     unités avec '/m²' inhibées (z9/p2[DEVICE_TYPE]/DeviceType/DEVTYPE_INHIBITM2
     à TRUE)
   - pour chaque unité de dilution validée dans <Dilution>, au moins une
     unité de débit massique compatible validée dans <MassFlow>, c'est à dire
     avec la partie unité (sans préfixe, ni temps, ni poids, ni surface)
     identique
   - un des 2 types de dilution parmi '/ml' (@PER_DIL_ML) et '/Xml'
     (@PER_DIL_XML) validé dans <EnablePer>
Note : la liste des unités de dilution est définie dans le logiciel :
   -  1: 'ng'          -  2: 'µg'          -  3: 'mg'          -  4: 'g'
   -  5: 'mmol'
   -  6: 'mU'          -  7: 'U'
   -  8: 'cal'         -  9: 'kcal'
   - 10: 'mEq'
Note : la liste des unités de débit massique est définie dans le logiciel :
                       -  1: 'ng/h'
   -  2: 'ng/kg/min'   -  3: 'ng/kg/h'
   -  4: 'µg/min'      -  5: 'µg/h'
   -  6: 'µg/kg/min'   -  7: 'µg/kg/h'
   -  8: 'mg/min'      -  9: 'mg/h'        - 10: 'mg/24h'
   - 11: 'mg/kg/min'   - 12: 'mg/kg/h'     - 13: 'mg/kg/24h'
                       - 14: 'mg/m²/h'     - 15: 'mg/m²/24h'
                       - 16: 'g/h'
   - 17: 'g/kg/min'    - 18: 'g/kg/h'      - 19: 'g/kg/24h'
                       - 20: 'mmol/h'
                       - 21: 'mmol/kg/h'   - 22: 'mmol/kg/24h'
   - 23: 'mU/min'
   - 24: 'mU/kg/min'   - 25: 'mU/kg/h'
   - 26: 'U/min'       - 27: 'U/h'
   - 28: 'U/kg/min'    - 29: 'U/kg/h'
                       - 30: 'kcal/h'      - 31: 'kcal/24h'
                       - 32: 'kcal/kg/h'
   - 33: 'mEq/min'     - 34: 'mEq/h'
   - 35: 'mEq/kg/min'  - 36: 'mEq/kg/h'
Note : modifié en Par 20 (sauf <EnablePer>/PER_U_ML).


$par 36 CARE_AREA_TYPE        type care area
   BOOL Dedicated   FALSE 0 1 care area active est une care area dédiée

Note : mis à jour lors de l'activation d'une care area.
Note : lorsque la care area active est une care area dédiée, la majorité des
menus de configuration est inaccessible.


                              validation mémorisation médicament
$par 37 ENABLE_MEM_DRUG $func $careareaopt
   WORD Mem **                modes mémorisation médicament
      $bit 0 @MEMD_DRUGONLY  FALSE * mémorisation numéro médicament uniquement
      $bit 1 @MEMD_DRUGPARAM FALSE * mémorisation numéro médicament et paramètres

Correct si :
   - <Mem>/MEMD_DRUGONLY et <Mem>/MEMD_DRUGPARAM pas tous les 2 deux armés
   - <Mem>/MEMD_DRUGPARAM à FALSE si mémorisation paramètres perfusion est
     inihibée (z9/p3[DEVICE_CONFIG]/DeviceConfig/DEVCNF_INHMEMDRUGPARAM à
     TRUE)
Note : champs <Mem>/MEMD_DRUGONLY et <Mem>/MEMD_DRUGPARAM modifiés en Par 3.


$par 40 BUZZER2 $carearea     paramètres effets sonore (dans care area)
   $value
   BYTE Mode        **        mode effets sonores
      $bit 0 @BUZ2_INHKEY  FALSE *  inhibition bip touche
   $value
   BYTE Level       7 1 7     niveau sonore, 1 le plus faible, 7 le plus fort

Note : champ <Mode>/BUZ2_INHKEY modifié en Par 1.
Note : champ <Level> modifié en Par 2 et dans écran du menu.


                              mémorisation paramètres perfusion
$par 41 MEM_INFUS_PARAM $careareadefonload
   WORD NumDrug     249 *     numéro dernier médicament sélectionné [$d!DRG_NUM()] :
                                   0 : sans nom médicament ml/h
                                 249 : inconnu "----"
                                 251 : "Médicament X (dose)"
                                 248 : "Médicament X (ml/h)"
                                 247 : sans nom médicament débit massique
                                 0300h + 1-200 : nom médicament ml/h
                                 0400h + 1-200 : nom médicament débit massique
                                 0500h + 1-200 : Vigilant Drug'Lib
   DWORD FlowRate     0 *     débit perfusion mode base, 1/1000 ml/h

Note : champ <NumDrug> toujours écrit à l'extinction en mode manuel :
   - avec numéro médicament courant si mémorisation numéro médicament seul
     (z22/p37[ENABLE_MEM_DRUG]/MEMD_DRUGONLY à TRUE) ou mémorisation numéro
     médicament et paramètres (z22/p37[ENABLE_MEM_DRUG]/MEMD_DRUGPARAM à TRUE)
   - avec 249 (inconnu) dans le cas contraire
Note : champs <FlowRate> toujours écrit à l'extinction en mode manuel :
   - avec la valeur courante si mémorisation numéro médicament et paramètres
     perfusion (z22/p37[ENABLE_MEM_DRUG]/MEMD_DRUGPARAM à TRUE) sauf si
     médicament courant est un médicament depuis la bibliothèque Vigilant
     Drug'Lib (zone 31) ou depuis la bibliothèque Tci (zone 32)
   - avec la valeur par défaut (0) dans le cas contraire
Note : ce paramètre est écrit avec les valeurs par défaut lors de l'extinction
en mode veille, configuration/test PC et configuration/test manuel si un des
paramètres liés à la configuration de la perfusion a été écrit, note #9.


$par 43 OPT_SCREEN2           options écran (pas dans care area)
   $value
   WORD Flags **                 flags options
      $bit 2 @OPTF2_DISCPOWER     TRUE  * gestion indication déconnexion secteur
      $bit 4 @OPTF2_ONCAREAREA    TRUE  * affichage écrans confirmation/sélection
                                          care area au démarrage
      $bit 5 @OPTF2_ONCAREAREASET TRUE  * affichage écran info. ensemble care
                                          areas après écran initial au démarrage
   $value @
   DWORD MnuScreen2 **        liste écrans du menu activés :
      $bit 0 @OPTS2_MAINT         FALSE * maintenance
      $bit 1 @OPTS2_DATETIME      FALSE * réglage date/heure
   $value
   WORD PumpCode   0 0 9999   code accès menu paramètres pompe, 0 pour accès
                              sans code

Note : champ <Flags>/OPTF2_DISCPOWER modifié en Pompe/Par 13.
Note : champ <Flags>/OPTF2_ONCAREAREA modifié en Pro 2.
Note : champ <Flags>/OPTF2_ONCAREAREASET modifié en Pro 4.
Note : champs <MnuScreen2>/OPTS2_MAINT et <MnuScreen2>/OPTS2_DATETIME
modifiés en Pompe/Util 2.
Note : champ <PumpCode> modifié en Test 20.


                              configurations diverses (dans care area)
$par 44 MISCELLANEOUS2 $careareaopt
   WORD Flags **              flags configuration *
                              inhibition sélection débit en cours perfusion
      $bit 0 @MISC2_INHSELFLOWINFUS FALSE *
                              durée perfusion cachée pendant exécution perfusion,
                              ignoré si état défini dans paramètres médicament
      $bit 3 @MISC2_HIDEDURATION    FALSE *

Note : champ <Flags>/MISC2_INHSELFLOWINFUS modifié en Par 34.
Note : la durée de perfusion cachée ou non avec bit @MISC2_HIDEDURATION
concerne :
   - la durée restante de perfusion pour le volume ou la dose en mode
     volume/temps
   - la durée avant l'alarme fin de perfusion (seringue vide) affichée
     lorsque la ligne d'information durée restante de perfusion est activée
     (paramètre z22/p18[OPT_SCREEN1]/InfoLine à 2)


                              numéro d'inventaire, notes #2 et #5
$par 48 INVENTORY_NUMBER $func
   STRING(20) Number   **

Note : ce paramètre n'est pas exploité par l'application. Il est uniquement
stocké pour être fourni lors d'une lecture avec une commande Id-20h.


$par 49 HOSPITAL_NAME $func   nom hôpital, notes #2 et #5
   STRING(20) Name    **

Note : ce paramètre n'est pas exploité par l'application. Il est uniquement
stocké pour être fourni lors d'une lecture avec une commande Id-20h.


$par 51 WIFI_STATE            état module Wifi
   BOOL Enable       TRUE 0 1 module Wifi activé

Note : modifié en Pompe/Util 14.
Note : l'état actif ou inactif du module Wifi défini avec ce paramètre n'est
pas traité par le logiciel (sauf pour prendre en compte ou non le courant
consommé par le module Wifi défini avec le paramètre z20/p2[WIFI_CURRENT]).
Le contenu du champ <Enable> est uniquement fourni au module Wifi avec la
donnée DataId-33h de la commande Id-42h.


$par 52 SERVER_MODE $noconfpc mode serveur
   BOOL Enable      FALSE 0 1 mode serveur activé

Note : ce paramètre n'est pas exploité par l'application. Il est uniquement
stocké pour être fourni lors d'une lecture avec une commande Id-20h.


                              tableau indicateurs seringues sélectionnables
                              (dans care area)
$par 53 SEL_SYR_2 $careareaopt
   $usestruct SelSyr

Note : pour qu'une seringue soit sélectionnable, il faut que l'indicateur
correspondant à son numéro de référence soit à TRUE dans ce paramètre *ET*
dans le paramètre z22/p15[SEL_SYR].
Note : les seringues dont l'indicateur est à FALSE dans ce paramètre ne sont
pas affichées Pompe/Par 6.


                              limitation liste médicaments en fonction
                              seringue sélectionnéee
$par 54 SYR_DRUG $func $careareaopt
   $struct SyrDrugItem [50]   couple numéros référence seringue et médicament *
                              numéro référence seringue sélectionnée, 0 si
                              fin liste couples
      BYTE NumRefSyr 0 0 NB_SYR_REFERENCES
                              numéro médicament autorisé si sélection
                              seringue <NumRefSyr>, 0 si fin liste couples
      BYTE NumDrug   0 0 NB_DRUGS

Correct si :
   - numéro médicament <NumDrug> à 0 si numéro référence seringue <NumRefSyr>
     est à 0
   - numéro médicament <NumDrug> différent de 0 si numéro référence seringue
     <NumRefSyr> est différent de 0
   - tous les couples avec les 2 numéros à 0 en fin de liste
Note : après la sélection d'une seringue, la liste des couples est parcourue
(jusqu'au 1er numéro référence seringue <NumRefSyr> à 0). Si le numéro de
référence de la seringue sélectionnée est présent dans la liste (une fois ou
plusieurs fois), la liste des médicaments proposés est limitée aux numéros de
médicaments dans les couples correspondant. Si le numéro de référence de la
seringue sélectionnée est absent, la liste des médicaments proposés contient
tous les médicaments configurés.
Note : le numéro médicament <NumDrug> permet de référencer un médicament
dans la bibliothèque active selon le mode de programmation :
   - liste noms médicaments en zone 30 si mode "Nom médicament ml/h" ou
     "Nom médicament débit massique"
   - bibliothèque Vigilant Drug'Lib en zone 31 si mode "Vigilant Drug'Lib"
   - bibliothèque Tci (en zone 32) si mode "Tci"
Note : il n'est pas possible avec ce paramètre de supprimer "Médicament X (ml/h)"
ou "Médicament X (dose)" de la liste s'ils sont autorisés avec le paramètre
z22/p25[PROGRAM_MODE]/DrugEnable.


$par 55 MEM_SEL2 $careareaopt mémorisation infos modifiables en mode manuel
                              (2ème groupe)
   $value                     verrouillage clavier automatique activé
   BOOL AutoKbdLock  FALSE 0 1

Note : champ <AutoKbdLock> modifié en Par 39.
Note : champ <AutoKbdLock> mis à jour avec état courant à l'extinction.


                              verrouillage clavier automatique
$par 56 AUTO_KBD_LOCK $careareaopt
   $value
   BYTE Flags **              flags verrouillage clavier automatique
      $bit 0 @LOCK_SELMENU FALSE *  sélection activation/désactivation
                                    verrouillage clavier automatique dans
                                    menu manuel
   $value
                              durée avant reverrouillage clavier automatique
                              si déverrouillage en cours perfusion
   BYTE DurBeforeLock  30 15 60

Note : champs <Flags>/LOCK_SELMENU et <DurBeforeLock> modifiés en Par 39.


$par 57 KBD_UNLOCK_CODE $func code déverrouillage clavier
   WORD KbdUnlockCode 0 0 4444   code déverrouillage, 0 pour déverrouillage
                                 clavier sans code

Correct si :
   - code <KbdUnlockCode> composé de 4 digits entre 0 et 4
Note : modifié en Pompe/Par 38.



/*-------------------------------------------------------------------------*/
/* Zone initialisation                                                     */
/*-------------------------------------------------------------------------*/

$zone 23 INIT I               zone initialisation


$par 1 INFOS $noconfpc $func  informations sur la zone
   $usestruct InfosZone

Note : le champ <ManChg> est mis à jour avec la date/heure utilisateur
courante lors d'une modification d'un paramètre de la zone en
configuration/test manuel. Il n'est pas modifié lors de l'écriture d'un
paramètre à l'extinction de l'appareil en mode manuel.
Note : informations affichées en Test 1 si paramètre présent et valide mais
pas traitées par application.


$par 4 DUR_UTIL               durée totale utilisation
   $usestruct DurUtil         durée totale utilisation et nombre total de
                              démarrages

Note : à chaque extinction, la durée depuis le démarrage précédent est cumulée
à <DurUtil>/<Duration> et <DurUtil>/<NbOn> est incrémenté. Suite à une
écriture puis un redémarrage, le contenu de ce paramètre est donc différent
lors de la prochaine lecture.


$par 7 INITIAL_CONFIG         configuration initiale
   BOOL InitialConfig FALSE 0 1 `- TRUE configuration initiale (choix langue)
                                        effectuée
                                 - FALSE configuration initiale non effectuée,
                                         écran choix langue au démarrage

Note : modifié en SAV 2.


$par 8 AUTONOMY $noconfpc     autonomie batterie
   SWORD CorrCapa    0 -1000 200  capacité corrective batterie, mAh
   BYTE CoeffCur   100    80 120  coefficient correcteur courant consommé
                                  théorique, %, 0.80 à 1.20


$par 9 TOT_DIST $noconfpc     distance totale parcourue par poussoir, mm
   DWORD Dist 0 *

Note : avec une avance poussoir de 115 mm, il est possible de cumuler plus
de 37 million d'avances, soit autant de seringues de 60 cc ce qui représente
2.2 millions de litre, soit 213 ans à 1200 ml/h.
Note : à chaque extinction, la distance parcourue par le poussoir depuis le
démarrage précédent est cumulée à <Dist>. Suite à une écriture puis un
redémarrage, le contenu de ce paramètre peut donc être différent lors de la
prochaine lecture si une fonction Cmd-41h/FuncId-0Dh pour commander le moteur
a été utilisée en mode configuration/test PC en même temps que l'écriture et
le stockage de ce paramètre.
Note : affichée en Test 2.



/*-------------------------------------------------------------------------*/
/* Zone SAV                                                                */
/*-------------------------------------------------------------------------*/

$zone 25 AFTER_SALE AS        zone SAV


$par 1 INFOS $noconfpc $func  informations sur la zone
   $usestruct InfosZone

Note : champ <ManChg> jamais mis à jour car aucun des paramètres n'est
modifiés dans les menus de configurations et de tests.
Note : informations affichées en Test 1 si paramètre présent et valide mais
pas traitées par application.


                              commentaires SAV
$par 2 COMMENT $func $noconfpc
   $structname AfterSaleComment
   STRING(150) Comment **     commentaires SAV, notes #4 et #5

Note : ce commentaire est affiché en Test 3.


                              durées test batterie
$par 3 DUR_TEST_BAT $noconfpc
   DATETIME DateStore DMM_DT  date/heure utilisateur stockage durées
   DWORD DurBatPreAl  **      durée depuis passage sur batterie jusqu'à
                              déclenchement pré-alarme, s
   DWORD DurBatAl     **      durée depuis passage sur batterie jusqu'à
                              déclenchement alarme, s
   DWORD DurAlOff     **      durée depuis déclenchement alarme jusqu'à
                              extinction automatique, s, 0 si durée inconnue
                              à cause extinction anormale

Note : les durées sont stockées uniquement lors d'une extinction automatique
après une alarme batterie. Si l'appareil s'éteint de manière anormale après
une alarme batterie, les durées sont actualisées lors de la prochaine mise
sous tension ; la date de stockage est alors la date de l'alarme et la durée
jusqu'à l'extinction est mise à 0.



/*-------------------------------------------------------------------------*/
/* Zone sauvegarde                                                         */
/*                                                                         */
/* Note : cette zone sert uniquement à stocker des informations lors de    */
/* l'extinction de l'appareil qui sont nécessaires pour les différentes    */
/* fonctions de mémorisation. Aucun des paramètres de cette zone ne        */
/* provoque le passage en configuration PC de l'appareil s'il est absent   */
/* ou erroné. Il n'est pas utile d'initialiser cette zone au moment de     */
/* la production de l'appareil ; il est préférable de l'effacer après une  */
/* intervention de maintenance.                                            */
/*-------------------------------------------------------------------------*/

$zone 26 SAVE S               zone sauvegarde


$par 1 INFOS $noconfpc $func  informations sur la zone
   $usestruct InfosZone

Note : champ <ManChg> jamais mis à jour car aucun des paramètres n'est
modifiés dans les menus de configurations et de tests.
Note : informations affichées en Test 1 si paramètre présent et valide mais
pas traitées par application.


                              informations pour fonction même perfusion
$par 3 CONTEXT $noconfpc $careareadefonload
   $structname ContextBase    contexte de base
   DATETIME DateSave      **  date/heure utilisateur sauvegarde informations,
                              à 0 si pas de sauvegarde informations
   $struct ContextGeneral     contexte général
      BYTE InfusMode      **  mode perfusion primaire [e_infusMode!..\Control.h]
      BOOL StartInfus     **  perfusion démarrée depuis fin programmation
   $struct ContextDrug        contexte médicament
      WORD NumDrug        **  numéro médicament [$d!DRG_NUM()]
   $struct ContextVolume      contexte volumes
      DWORD VolInfus      **  volume perfusé, nl
      DATETIME StartInfus **  date/heure interne départ perfusion
   $struct ContextPressure    contexte pression
      WORD PressLim       **  limite pression, mmHg
      BOOL DpsAuto        **  surveillance pression activée
   $struct ContextInfusBase   contexte perfusion mode de base
      DWORD FlowRate      **  débit, nl/h
   $struct ContextVolTime     contexte perfusion mode volume/temps
      DWORD FlowRate      **  débit, nl/h
      DWORD VolToInfus    **  volume restant à perfuser, nl
      DWORD KvoFlowRate   **  débit Kvo, 1/1000 ml/h, 0, DWORD_MAX
   $struct ContextVolLimit    contexte volume limite
      DWORD VolLimit      **  volume limite, nl, à 0 si pas de volume limite
      DWORD KvoFlowRate   **  débit Kvo, 1/1000 ml/h, 0, DWORD_MAX

Note : ce paramètre est écrit avec les valeurs par défaut et donc on
considère qu'il n'y a pas d'informations sauvegardées (et donc pas d'écran
même perfusion au démarrage) dans les cas suivants :
   - extinction en mode veille et configuration/test PC :
        . si changement date/heure utilisateur avec commande Id-53h
        . si écriture n'importe quel paramètre (commande(s) Id-21h suivie
          de commande Id-22h)
   - extinction en mode configuration/test manuel :
        . si changement date/heure utilisateur avec commande Id-53h
        . si modification de n'importe quel paramètre depuis un des écrans
          de configuration
Note : on peut donc considérer que ce paramètre est en lecture seule puisque
une écriture avec une commande Id-21h provoque systématiquement sa ré-écriture
avec les valeurs par défaut.


                              informations pour fonction même perfusion pour
                              un appareil MC
$par 7 CONTEXT_MC $noconfpc $onlyMC
   $structname ContextBaseMC  contexte de base MC
   $struct ContextDrugMC      contexte médicament
      DWORD Dilution      **  valeur dilution, 1/1000 unité, 0 si pas dilution
      UNIT DilutionUnit   **  unité dilution, 0 si pas dilution
      WORD DilutionVolume **  volume associé à dilution, ml, 0 si pas dilution
   $struct ContextVolumeMC    contexte volumes
      DWORD MassInfus     **  masse perfusée, 1/1000 unité, à 0 si volume ml
      UNIT DoseInfusUnit  **  unité dose perfusée, unité masse ou ml
   $struct ContextInfusBaseMC contexte perfusion mode de base
      DWORD MassFlow      **  débit massique, 1/1000 unité, à 0 si débit ml/h
      UNIT FlowRateUnit   **  unité débit, unité débit massique ou ml/h
   $struct ContextVolTimeMC   contexte perfusion mode volume/temps
      DWORD MassFlow      **  débit massique, 1/1000 unité, à 0 si débit ml/h
      UNIT FlowRateUnit   **  unité débit, unité débit massique ou ml/h
      DWORD MassToInfus   **  masse restant à perfuser, 1/1000 unité, à 0 si
                              dose en ml
      UNIT DoseToInfusUnit ** unité dose restant à perfuser, unité masse ou ml
   $struct ContextVolLimitMC
      DWORD MassLimit     **  masse limite, 1/1000 unité, à 0 si pas de volume
                              limite ou si volume ml
      UNIT DoseLimitUnit  **  unité dose limite, unité masse ou ml
   $struct ContextBolusProg   contexte bolus programmé
      DWORD VolDefault    **  volume par défaut, nl
      DWORD Duration      **  durée par défaut, s
      UNIT Unit           **  unité volume/masse à perfuser
      BOOL Programmed     **  programmation effectuée au moins une fois
   $struct ContextFunc        contexte fonction perfusion
      BYTE InfusMode      **  mode perfusion, dose charge ou bolus programmé,
                              0 si pas fonction perfusion en cours, bit 7 à 1
                              si démarrage bolus programmé en cours perfusion
                              [$m7F!e_infusMode!..\Control.h]
      DWORD FlowRate      **  débit, nl/h
      DWORD VolToInfus    **  volume restant à perfuser, nl
      DWORD VolDefault    **  volume par défaut dose charge (dernier volume
                              sélectionné), nl
      UNIT UnitLoad       **  unité volume/masse à perfuser dose charge
   $struct ContextPatient     contexte patient
      DWORD Weight        **  poids patient, g, 0 si unité sans /kg
      WORD Bsa            **  surface patient, 1/1000 m², 0 si unité sans /m²
   $struct ContextClinicalInfo contexte information clinique
                              [e_clinfoState!..\Control\ClinicalInfo.c] :
      BYTE State          **  état information clinique
                                 0 : pas gestion information clinique
                                 1 : attente départ perfusion pour lancement
                                     temporisation
                                 2 : temporisation avant affichage information
                                     clinique en cours
                                 3 : message information clinique affiché,
                                     temporisation terminée
                                 4 : message information clinique acquitté avec
                                     appui sur touche SILENCE ALARME
      DATETIME DateMsg    **  date/heure utilisateur besoin affichage
                              information clinique, uniquement si <State> à 2,
                              à 0 dans les autres cas

Note : le contenu de ce paramètre est exploité uniquement si des informations
pour fonction même perfusion sont disponibles, c'est à dire paramètre
z26/p3[CONTEXT]/DateSave différent de 0.
Note : les champs suivants sont présents dans le contexte car ils sont
utilisés pour l'affichage de l'écran même perfusion mais ils ne sont pas
exploiter pour restaurer des données :
   - unités débit <ContextInfusBaseMC>/<FlowRateUnit> et
     <ContextVolTimeMC>/<FlowRateUnit>, extraites depuis paramètres médicament
   - masse perfusée <MassInfus>, recalculée à partir volume perfusé
   - unité dose perfusée <DoseInfusUnit>, extraite depuis paramètres médicament
   - masse restant à perfuser de volume/temps <MassToInfus>, recalculée à
     partir volume restant à perfuser de volume/temps
   - unité dose restant à perfuser de volume/temps <DoseToInfusUnit>,
     extraite depuis paramètres médicament
   - masse limite <MassLimit>, recalculée à partir volume limite
   - unité masse limite <DoseLimitUnit>, extraite depuis paramètres médicament

                              informations pour fonction même perfusion pour
                              un appareil Tiva
$par 10 CONTEXT_TCI $noconfpc $onlyTiva
   $structname ContextBaseTci contexte de base Tci
   $struct ContextTci         contexte Tci
      BYTE State          **  état Tci [e_tciState!..\Control\Tci.c]
      BYTE Mode           **  mode Tci [e_tciMode!..\Control.h] :
                                 1 : plasma
                                 2 : effet
      DWORD Target        **  concentration cible, 1/1000 unité
      UNIT TargetUnit     **  unité concentration cible
      DWORD InfusDuration **  durée perfusion en mode Tci, ms, à 0 si
                              perfusion Tci pas démarrée
      DWORD WakeUp        **  concentration réveil, 1/1000 unité
      FLOAT Fmc           **  masse compartiment plasma
      FLOAT Fm2           **  masse compartiment intermédiaire n|2
      FLOAT Fm3           **  masse compartiment intermédiaire n|3
      FLOAT Fme           **  masse compartiment effet
      WORD IndDuration    **  durée induction, s, 0 pour 'Flash'
   $struct ContextCtrTci      contexte contrôle Tci
      FLOAT Fmc           **  masse compartiment plasma
      FLOAT Fm2           **  masse compartiment intermédiaire n|2
      FLOAT Fm3           **  masse compartiment intermédiaire n|3
      FLOAT Fme           **  masse compartiment effet
   $struct ContextVolumeTci   contexte volume
      DWORD VolInfusHigh  **  32 bits poids fort volume perfusé, nl
      DWORD VolInfusLow   **  32 bits poids faible volume perfusée, nl
   $struct ContextPatientTci  contexte patient
      WORD Age            **  âge patient, mois
      BYTE Gender         **  sexe patient [PAT_GEND_!..\Control.h] :
                                 0 : inconnu, si médicament Tci pour lequel
                                     le sexe n'est pas nécessaire
                                 1 : homme
                                 2 : femme
      WORD Height         **  taille patient, cm

Note : voir note z26/p3[CONTEXT_MC].
Note : les champs suivants sont présents dans le contexte car ils sont
utilisés pour l'affichage de l'écran même perfusion mais ils ne sont pas
exploiter pour restaurer des données :
   - mode Tci <Mode>, extrait depuis paramètres médicament
   - unité concentration cible <TargetUnit>, extraite depuis paramètres
     médicament


                              informations pour fonction même perfusion pour
                              écran perfusion Tci graphique
$par 11 CONTEXT_TCI_GRAPH $noconfpc $onlyTiva
   DATETIME StartInfus    **  date/heure interne départ perfusion Tci, à 0 si
                              perfusion Tci pas démarrée
   DATETIME FirstDataItem **  date/heure interne correspondant à 1er élément
                              dans paramètre z26/p12[CONTEXT_TCI_GRAPH_DATA].
   WORD NbDataItem        **  nombre éléments dans paramètre
                              z26/p12[CONTEXT_TCI_GRAPH_DATA], 1 à 333
   DWORD MaxEffect        **  concentration effet maximum depuis début
                              perfusion Tci, 1/1000 unité (voir
                              z26/p10[CONTEXT_TCI]/Unit)

Note : le contenu de ce paramètre est exploité uniquement si des informations
pour fonction même perfusion sont disponibles, c'est à dire paramètre
z26/p3[CONTEXT]/DateSave différent de 0 et que le mode de perfusion au moment
de la sauvegarde de contexte est le mode Tci.
Note : tous les champs de ce paramètre sont écrits à 0 au moment de
l'extinction si :
   - le mode de perfusion courant est autre que le mode Tci
   - la perfusion Tci n'a pas encore démarrée
Note : ce paramètre et le paramètre z26/p12[CONTEXT_TCI_GRAPH_DATA] permettent
de remettre l'écran perfusion Tci graphique dans le même état lors d'une
restauration de contexte après un démarrage de perfusion Tci.


                              tableaux éléments pour fonction même perfusion
                              pour écran perfusion Tci graphique
$par 12 CONTEXT_TCI_GRAPH_DATA [11] $noconfpc $onlyTiva
                              tableau éléments pour écran perfusion Tci graphique
   $struct ContextTciGraphDataItem [31]
      DWORD Plasma        **   concentration plasma, 1/1000 unité
      DWORD Effect        **   concentration effet, 1/1000 unité

Note : voir note z26/p11[CONTEXT_TCI_GRAPH].
Note : ce paramètre permet de stocker un maximum de 341 éléments (11 x 31)
correspondant aux concentrations sur les dernières 50 minutes de perfusion
Tci avec un échantillonnage toutes les 9 s.
Note : l'unité pour les concentrations plasma <Plasma> et effet <Effect> est
définies avec z26/p10[CONTEXT_TCI]/Unit.
Note : la présence et le contenu de ce paramètre sont indéterminés si
z26/p11[CONTEXT_TCI_GRAPH]/StartInfus est à 0.
                              
                              
                              mémorisation état clavier verrouillé
$par 14 MEM_KBD_LOCK $noconfpc
   BOOL KbdLock  FALSE 0 1    état clavier verrouillé

Note : champ <KbdLock> mis à jour avec état courant à l'extinction.



/*-------------------------------------------------------------------------*/
/* Zone care area                                                          */
/*                                                                         */
/* Note : à priori, zone pas modifiée avec des commandes liaison série     */
/* mais uniquement suite au chargement d'une care area.                    */
/*-------------------------------------------------------------------------*/

$zone 27 CARE_AREA CA         zone care area


                              informations sur la zone
$par 1 INFOS $noconfpc $func $careareaopt
   $usestruct InfosZone

Note : champ <ManChg> jamais mis à jour car aucun des paramètres n'est
modifiés dans les menus de configurations et de tests.
Note : informations affichées en Test 1 si paramètre présent et valide mais
pas traitées par application.


                              nom care area
$par 2 NAME $noconfpc $func $carearea
   $structname CareAreaName
   STRING(20) Name       **   nom care area, note #2

Note : c'est ce nom qui apparaît dans les différents écrans pour identifier
la care area. Une chaîne vide est interdite pour les care areas 1 à 20.
Il peut y avoir une chaîne vide pour la care area sauvegarde paramètres
courants.


                              auteur care area
$par 3 AUTHOR $noconfpc $func $carearea
   $structname CareAreaAuthor
   STRING(20) AuthorName **   nom auteur de la care area, notes #2 et #5


                              version care area
$par 4 VERSION $noconfpc $carearea
   $structname CareAreaVersion
                              version de la care area, "vvrc", notes #1 et #5
   STRING(4) Version     * "    " "~~~~"


                              date/heure création et modification care area
$par 5 DATE $noconfpc $carearea
   $structname CareAreaDate
   DATETIME Create  DMM_DT    date/heure utilisateur création care area,
                              0 si non spécifiée
   DATETIME Modif   DMM_DT    date/heure utilisateur modification care area,
                              0 si non spécifiée


                              commentaire care area
$par 6 COMMENT $noconfpc $func $careareaopt
   $structname CareAreaComment
   STRING(150) Comment   **   commentaire de la care area, notes #4 et #5

Note : visualisable avec les autres informations de la care area juste avant
son chargement.


                              identifiant unique care area
$par 7 GUID $noconfpc $carearea $func @par_ValidCareAreaGuid
   DWORD Data1           **   bits 0-31 de l'identifiant 128 bits [$h]
   WORD Data2            **   bits 32-47 de l'identifiant 128 bits [$h]
   WORD Data3            **   bits 48-63 de l'identifiant 128 bits [$h]
   BYTE[8] Data4         **   bits 64-127 de l'identifiant 128 bits [$h] *

Note : doit être différent de 0 pour care area dédiée ; peut être tout à 0
pour care area générique.


                              date/heure écriture care area
$par 8 DATE_WRITE $noconfpc $carearea
   $structname CareAreaDateWrite
   DATETIME Write   DMM_DT    date/heure utilisateur écriture care area,
                              0 si non spécifiée


                              type logo care area
$par 9 LOGO $noconfpc $careareaopt
   BYTE LogoType    0  0  1   type logo care area :
                                 0 : pas de logo
                                 1 : logo phare



/*-------------------------------------------------------------------------*/
/* Zones bibliothèques médicaments                                         */
/*                                                                         */
/* Note : voir ParamDrug.txt pour description des paramètres 2 et 3 de     */
/* chaque zone qui sont des paramètres avec longueur variable.             */
/*-------------------------------------------------------------------------*/

$zone 30 LIB_DRUG_LIST LDL    bibliothèque liste noms médicaments (pour mode
                              liste noms médicaments)


                              informations sur la zone
$par 1 INFOS $noconfpc $func $careareaopt
   $usestruct InfosZone


                              informations sur la bibliothèque
$par 2 INFOS_LIB $careareaopt $nofield


                              tableau paramètres médicaments
$par 3 PARAM_DRUG [DRUGS] $accuracy $careareaopt $nofield

Note : voir note #6.



$zone 31 LIB_VIGILANT LV      bibliothèque Vigilant Drug'Lib (pour mode
                              Vigilant Drug'Lib)


                              informations sur la zone
$par 1 INFOS $noconfpc $func $onlyMC $careareaopt
   $usestruct InfosZone


                              informations sur la bibliothèque
$par 2 INFOS_LIB $onlyMC $careareaopt $nofield


                              tableau paramètres médicaments
$par 3 PARAM_DRUG [DRUGS] $accuracy $onlyMC $careareaopt $nofield

Note : voir note #6.



$zone 32 LIB_TCI LTCI         bibliothèque Tci (pour mode Tci)


                              informations sur la zone
$par 1 INFOS $noconfpc $func $onlyMC $onlyTiva $careareaopt
   $usestruct InfosZone


                              informations sur la bibliothèque
$par 2 INFOS_LIB $onlyMC $onlyTiva $careareaopt $nofield


                              tableau paramètres médicaments
$par 3 PARAM_DRUG [DRUGS] $accuracy $onlyMC $onlyTiva $careareaopt $nofield

Note : voir note #6.



/*-------------------------------------------------------------------------*/
/* Notes                                                                   */
/*-------------------------------------------------------------------------*/

Note #1 : chaîne avec caractères ASCII standard uniquement (20h à 7Eh)
Note #2 : chaîne en page codes 1252 par défaut sauf si échappement sélection
          page codes en 1er caractère, accepte tous les caractères ASCII
          standard (20h à 7Fh) et les caractères ASCII étendus du page codes
          (80h à FFh), n'accepte aucun code contrôle sauf échappement page
          codes en 1er caractère, doit contenir au moins un caractère après
          échappement page codes, si chaîne plus courte que la longueur
          maximum, ne doit contenir que des 0 après le 1er 0 de fin de chaîne
Note #3 : chaîne avec codage non spécifié car jamais affichée par le logiciel
Note #4 : idem note #2 mais accepte de plus le code de contrôle 0Ah pour
          passer à la ligne
Note #5 : chaîne vide (tout à 0) autorisée

Note #6 : la validité de tous les paramètres qui comportent l'attribut
          $accuracy est liée à la précision fine ou grosse pour un débit ml/h.
          Cette précision provient du paramètre z8/p2[ACCURACY].
          Gestion avec care area :
          - ce paramètre est optionnel dans les care areas (attribut
            $careareaopt)
          - s'il est absent, c'est la précision par défaut qui est utilisée
            soit la précision grosse (jamais 2 décimales)
          - pour l'écriture dans une care area avec une commande Id-25h d'un
            paramètre qui comporte l'attribut $accuracy :
               . si le paramètre z8/p2[ACCURACY] n'a pas été écrit
                 auparavant, la vérification de validité se fait avec la
                 précision grosse. Par contre, une erreur ErrId-27h
                 [ERRCAREAREAACCURACY] est retournée si le paramètre
                 z8/p2[ACCURACY] est écrit par la suite (y compris si
                 précision définie dans le paramètre est la valeur par
                 défaut)
               . si le paramètre z8/p2[ACCURACY] a été écrit auparavant, la
                 vérification de validité se fait avec la précision définie
                 dans le paramètre
          Gestion avec paramètres courants :
          - pour l'écriture des paramètres courants avec une commande Id-21h,
            d'un paramètre qui comporte l'attribut $accuracy, la vérification
            de validité se fait :
               . soit avec la précision dans le paramètre z8/p2[ACCURACY]
                 stocké précédemment (ou la valeur par défaut si paramètre
                 absent)
               . soit avec la précision dans le paramètre z8/p2[ACCURACY]
                 reçue dans une commande Id-21h précédente
          - si le paramètre z8/p2[ACCURACY] est écrit *APRES* un paramètre
            avec l'attribut $accuracy, il n'y a pas de nouvelle vérification
            des paramètres écrits précédemment. On peut dans ce cas avoir un
            passage en configuration/test PC lors du prochain démarrage car
            un paramètre ne respecte pas les contraintes avec la nouvelle
            précision

Note #7 : valeur débit ml/h :
          - correcte si précision fine :
               . multiple de 10 (0.01 ml/h) si comprise entre 100 (0.10 ml/h)
                 et 9990 (9.99 ml/h)
               . multiple de 100 (0.1 ml/h) si comprise entre 10000 (10.0 ml/h)
                 et 99900 (99.9 ml/h)
               . multiple de 1000 (1 ml/h) si supérieure à 100000 (100 ml/h)
          - correcte si précision grosse :
               . multiple de 100 (0.1 ml/h) si comprise entre 100 (0.1 ml/h)
                 et 99900 (99.9 ml/h)
               . multiple de 1000 (1 ml/h) si supérieure à 100000 (100 ml/h)
          - voir note #6

Note #8 : valeur poids patient :
          - correcte si :
               . multiple de 10 (0.01 kg) si comprise entre 250 (0.25 kg) et
                 9990 (9.99 kg)
               . multiple de 100 (0.1 kg) si comprise entre 10000 (10.0 kg) et
                 19900 (19.9 kg)
               . multiple de 1000 (1 kg) si supérieure à 20000 (20 kg)

Note #9 : les paramètres suivants sont utilisés pour sauvegarder un état de
l'appareil à l'extinction :
   - paramètres mode débit massique z22/p26[MEM_MASSFLOW]
   - paramètres perfusion z22/p41[MEM_INFUS_PARAM].
Tous ces paramètres sont écrits avec leurs valeurs par défaut lors de
l'extinction en mode veille, configuration/test PC et configuration/test
manuel si un des paramètres suivants liés à la configuration de la perfusion
a été écrits (y compris si ré-écriture même valeur) :
   - précision débit ml/h et volume ml z8/p2[ACCURACY]
   - mémorisation mode programmation z22/p9[MEM_PROGRAM_MODE]
   - débits maximum au clavier z22/p12[MAX_FLOWRATE]
   - paramètres modes programmation z22/p25[PROGRAM_MODE]
   - paramètres patient z22/p28[PARAM_PATIENT]
   - validation des unités z22/p32[ENABLE_UNIT]
   - validation mémorisation médicament z22/p37[ENABLE_MEM_DRUG]
   - paramètres médicaments bibliothèque liste noms médicaments z30/p3[PARAM_DRUG]
   - paramètres médicaments bibliothèque Vigilant Drug'Lib z31/p3[PARAM_DRUG]
   - paramètres médicaments bibliothèque Tci z32/p3[PARAM_DRUG]
   - un des paramètres utilisés pour sauvegarder un état listé ci-dessus
On peut donc considérer que les paramètres utilisés pour sauvegarder un état
sont en lecture seule puisque une écriture du paramètre avec une commande
Id-21h provoque systématiquement sa ré-écriture avec les valeurs par défaut.



/*-------------------------------------------------------------------------*/
/* Echappements sélection page codes                                       */
/*-------------------------------------------------------------------------*/

Les chaînes de caractères dans les paramètres qui contiennent des caractères
ASCII étendus de 80h à FFh peuvent spécifier dans quelle page de codes ces
caractères doivent être analysés s'il ne s'agit pas de la page de codes 1252.
La chaîne doit dans ce cas débuter par un des échappements sélection page
de codes suivant :
   01h : page codes 1251 (cyrillique)
   02h : page codes 1252 (Europe de l'ouest)
   03h : page codes 1253 (grec)
   04h : page codes 1254 (turc)
   05h : page codes 1255 (hébreu)
   06h : page codes 1256 (arabe)
   07h : page codes 1257 (baltique)
   08h : page codes 1258 (vietnam)
   10h : page codes 1250 (Europe centrale)
   11h : page codes 874 (thai)
   12h : page codes 932F (japonais simplifié Fresenius)
   13h : page codes 936F (chinois simplifié Fresenius)
